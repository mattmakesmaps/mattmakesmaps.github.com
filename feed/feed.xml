<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:base="en">
	<title>mattmakesmaps</title>
	<subtitle>Matthew Matt Kenny GIS and woodworking blog.</subtitle>
	<link href="https://mattmakesmaps.com/feed/feed.xml" rel="self"/>
	<link href="https://mattmakesmaps.com/"/>
	<updated>2023-11-08T00:00:00Z</updated>
	<id>https://mattmakesmaps.com/</id>
	<author>
		<name>Matt Kenny</name>
		<email></email>
	</author>
	
	<entry>
		<title>Python Dev Setup on Mac | Gotchas Documented</title>
		<link href="https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/"/>
		<updated>2023-11-08T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/</id>
		<content type="html">&lt;h1 id=&quot;tool-installation&quot; tabindex=&quot;-1&quot;&gt;Tool Installation &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;Here are some personal notes on getting Python setup for my new Mac.&lt;/p&gt;
&lt;h2 id=&quot;python-base-install&quot; tabindex=&quot;-1&quot;&gt;Python Base Install &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Install &lt;a href=&quot;https://brew.sh/#install&quot;&gt;Homebrew&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Install Python 3 via homebrew: &lt;code&gt;brew install python&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;At this point, you can use &lt;code&gt;python3&lt;/code&gt; and &lt;code&gt;pip3&lt;/code&gt; commands, but for &lt;code&gt;pipenv&lt;/code&gt; you&#39;ll need
to symlink &lt;code&gt;pip&lt;/code&gt; and &lt;code&gt;python&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To do this, note the &lt;code&gt;caveat&lt;/code&gt; message produced by &lt;code&gt;brew install python&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Python has been installed as
  /opt/homebrew/bin/python3

Unversioned symlinks `python`, `python-config`, `pip` etc. pointing to
`python3`, `python3-config`, `pip3` etc., respectively, have been installed into
  /opt/homebrew/opt/python@3.11/libexec/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We need to add the following to the end our &lt;code&gt;~/.zshrc&lt;/code&gt; file (Per this
&lt;a href=&quot;https://stackoverflow.com/questions/11530090/adding-a-new-entry-to-the-path-variable-in-zsh&quot;&gt;SO Post&lt;/a&gt;):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# point python to python3
path+=(&#39;/opt/homebrew/opt/python@3.11/libexec/bin&#39;)
export PATH
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;pipenv&quot; tabindex=&quot;-1&quot;&gt;Pipenv &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Get &lt;code&gt;pipenv&lt;/code&gt; setup to manage dependencies and virtual environments.
Reference &lt;a href=&quot;https://docs.python-guide.org/dev/virtualenvs/&quot;&gt;Hitchiker&#39;s Guide to Python&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The link above contains a previous section on Python base install. These instructions didn&#39;t
address symlinking &lt;code&gt;python&lt;/code&gt; to &lt;code&gt;python3&lt;/code&gt;. Instead of using these, follow notes in &lt;code&gt;Python Base Install&lt;/code&gt;
section above.&lt;/p&gt;
&lt;h2 id=&quot;vs-code&quot; tabindex=&quot;-1&quot;&gt;VS Code &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Linter: &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-python.pylint&quot;&gt;Pylint Extension&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Code formatter: &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=ms-python.black-formatter&quot;&gt;Black Formatter Extension&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;project-setup&quot; tabindex=&quot;-1&quot;&gt;Project Setup &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;h2 id=&quot;python-environment-with-pipenv&quot; tabindex=&quot;-1&quot;&gt;Python Environment With Pipenv &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cloning an existing project with a &lt;code&gt;Pipfile&lt;/code&gt;, run &lt;code&gt;pipenv install --dev&lt;/code&gt;. This creates
a new virtualenv and installs dependencies.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create a new project, just install the first dependency with &lt;code&gt;pipenv install &amp;lt;package foo&amp;gt;&lt;/code&gt;
from the project&#39;s root dir. That will generate the new virtual env.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; For better cross-compatibility with other systems, update the &lt;code&gt;Pipfile&lt;/code&gt; to reference
Python &lt;code&gt;3&lt;/code&gt; as opposed to a specific version e.g &lt;code&gt;3.11&lt;/code&gt;. See this
example &lt;a href=&quot;https://github.com/mattmakesmaps/kvru-utils/blob/main/mp3-convert/Pipfile#L13&quot;&gt;CL&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;visual-studio-code-launch-configuration&quot; tabindex=&quot;-1&quot;&gt;Visual Studio Code Launch Configuration &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2023-11-08-python-development-mac/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The following is an example script launch configuration. Note the relative path
to the script file in &lt;code&gt;program&lt;/code&gt; and the command line args in &lt;code&gt;args&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    &amp;quot;version&amp;quot;: &amp;quot;0.2.0&amp;quot;,
    &amp;quot;configurations&amp;quot;: [
        {
            &amp;quot;name&amp;quot;: &amp;quot;mp3-convert.py with test args&amp;quot;,
            &amp;quot;type&amp;quot;: &amp;quot;python&amp;quot;,
            &amp;quot;request&amp;quot;: &amp;quot;launch&amp;quot;,
            &amp;quot;program&amp;quot;: &amp;quot;${workspaceFolder}/mp3-convert/mp3-convert.py&amp;quot;,
            &amp;quot;console&amp;quot;: &amp;quot;integratedTerminal&amp;quot;,
            &amp;quot;justMyCode&amp;quot;: true,
            &amp;quot;args&amp;quot;: [
                &amp;quot;${workspaceFolder}/test_data/source&amp;quot;,
                &amp;quot;${workspaceFolder}/test_data/dest&amp;quot;
            ]
        }
    ]
}
&lt;/code&gt;&lt;/pre&gt;
</content>
	</entry>
	
	<entry>
		<title>FLDIGI on Mac With Digirig and Baofeng HT</title>
		<link href="https://mattmakesmaps.com/blog/2023-11-01-fldigi-baofeng/"/>
		<updated>2023-11-01T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2023-11-01-fldigi-baofeng/</id>
		<content type="html">&lt;p&gt;I participated for the first time in the weekly &lt;a href=&quot;https://www.psdhn.org/&quot;&gt;Puget Sound Digital Ham Net&lt;/a&gt;
this past Monday. This net specializes in sending digital data over the 2m and 70cm amateur radio bands
as opposed to traditional voice communication. This allows for text and image files to be sent over
a variety of different &amp;quot;digital modes&amp;quot;, although the most common for the group appeared to be
&lt;a href=&quot;http://www.w1hkj.com/modes/mfsk.htm&quot;&gt;multi-frequency shift keyed&lt;/a&gt; aka &lt;code&gt;MFSK128&lt;/code&gt;,
where the 128 indicates 128 baud or symbols per second. Pretty amazing to be able to send data across
Seattle without the internet.&lt;/p&gt;
&lt;p&gt;With the help of &lt;a href=&quot;https://www.qrz.com/db/KB7SDM&quot;&gt;Ryan KB7SDM&lt;/a&gt; and a great
&lt;a href=&quot;https://www.youtube.com/watch?v=zSX64XwJ0E4&quot;&gt;getting started presentation&lt;/a&gt;
a group member had put together, I was able to receive and decode other participants&#39; messages
using the &lt;a href=&quot;http://www.w1hkj.com/&quot;&gt;&lt;code&gt;fldigi&lt;/code&gt; software suite&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here is an example of a message transmitted by a net member, received by my radio, and decoded on my
macbook pro using &lt;code&gt;fldigi&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source type=&quot;image/webp&quot; srcset=&quot;https://mattmakesmaps.com/img/a6MA4y-4Pf-320.webp 320w, https://mattmakesmaps.com/img/a6MA4y-4Pf-600.webp 600w, https://mattmakesmaps.com/img/a6MA4y-4Pf-960.webp 960w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1280.webp 1280w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1600.webp 1600w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1920.webp 1920w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;source type=&quot;image/jpeg&quot; srcset=&quot;https://mattmakesmaps.com/img/a6MA4y-4Pf-320.jpeg 320w, https://mattmakesmaps.com/img/a6MA4y-4Pf-600.jpeg 600w, https://mattmakesmaps.com/img/a6MA4y-4Pf-960.jpeg 960w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1280.jpeg 1280w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1600.jpeg 1600w, https://mattmakesmaps.com/img/a6MA4y-4Pf-1920.jpeg 1920w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;img alt=&quot;Screenshot of fldigi software displaying decoded message.&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot; src=&quot;https://mattmakesmaps.com/img/a6MA4y-4Pf-320.jpeg&quot; width=&quot;1920&quot; height=&quot;1242&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Receiving was as easy as tuning my radio to the net frequency, and turning on my mac&#39;s microphone to
capture the sound from the radio&#39;s speaker. With regards to transmitting however, I wanted to be able
to connect the radio to directly the computer. This ensures maximum fidelity in the transmission,
and also allows the software to directly control the radio, &amp;quot;keying&amp;quot; or opening and closing the radio
for transmit only while sending a message. Alternatively, I&#39;d have to manually key the radio myself.&lt;/p&gt;
&lt;p&gt;In comes the &lt;a href=&quot;https://digirig.net/&quot;&gt;digirig&lt;/a&gt; a tiny piece of hardware that sits between the
radio and computer, and essentially acts as a usb soundcard enables software control of the radio
itself.&lt;/p&gt;
&lt;p&gt;Below you can see my handheld radio, a baofeng UV-5R, and the digirig interface. The digirig is connected
to the radio via an audio cable that plugs into both the radio&#39;s speaker and microphone jacks, allowing
for transmit and receive into the macbook pro. The digirig itself is connected to the computer via usb-c.&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source type=&quot;image/webp&quot; srcset=&quot;https://mattmakesmaps.com/img/KwSYhcmrto-320.webp 320w, https://mattmakesmaps.com/img/KwSYhcmrto-600.webp 600w, https://mattmakesmaps.com/img/KwSYhcmrto-960.webp 960w, https://mattmakesmaps.com/img/KwSYhcmrto-1280.webp 1280w, https://mattmakesmaps.com/img/KwSYhcmrto-1600.webp 1600w, https://mattmakesmaps.com/img/KwSYhcmrto-1920.webp 1920w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;source type=&quot;image/jpeg&quot; srcset=&quot;https://mattmakesmaps.com/img/KwSYhcmrto-320.jpeg 320w, https://mattmakesmaps.com/img/KwSYhcmrto-600.jpeg 600w, https://mattmakesmaps.com/img/KwSYhcmrto-960.jpeg 960w, https://mattmakesmaps.com/img/KwSYhcmrto-1280.jpeg 1280w, https://mattmakesmaps.com/img/KwSYhcmrto-1600.jpeg 1600w, https://mattmakesmaps.com/img/KwSYhcmrto-1920.jpeg 1920w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;img alt=&quot;A baofeng uv-5r handheld ham radio connected to a digirig interface.&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot; src=&quot;https://mattmakesmaps.com/img/KwSYhcmrto-320.jpeg&quot; width=&quot;1920&quot; height=&quot;2560&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Actually configuring the &lt;code&gt;fldigi&lt;/code&gt; software to key the radio via the digirig was a little tricky.
&lt;a href=&quot;https://forum.digirig.net/t/digirig-flrig-baofeng/580/4&quot;&gt;This post&lt;/a&gt; on the digirig forum
helped clear it up, however.&lt;/p&gt;
&lt;p&gt;I had to set my &lt;code&gt;fldigi&lt;/code&gt; software&#39;s &lt;code&gt;Hardware PTT&lt;/code&gt; controls to the following (open image in a new tab
to enlarge):&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source type=&quot;image/webp&quot; srcset=&quot;https://mattmakesmaps.com/img/oIxHPV3M4i-320.webp 320w, https://mattmakesmaps.com/img/oIxHPV3M4i-600.webp 600w, https://mattmakesmaps.com/img/oIxHPV3M4i-960.webp 960w, https://mattmakesmaps.com/img/oIxHPV3M4i-1280.webp 1280w, https://mattmakesmaps.com/img/oIxHPV3M4i-1600.webp 1600w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;source type=&quot;image/jpeg&quot; srcset=&quot;https://mattmakesmaps.com/img/oIxHPV3M4i-320.jpeg 320w, https://mattmakesmaps.com/img/oIxHPV3M4i-600.jpeg 600w, https://mattmakesmaps.com/img/oIxHPV3M4i-960.jpeg 960w, https://mattmakesmaps.com/img/oIxHPV3M4i-1280.jpeg 1280w, https://mattmakesmaps.com/img/oIxHPV3M4i-1600.jpeg 1600w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;img alt=&quot;fldigi configuration menu for baofeng use.&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot; src=&quot;https://mattmakesmaps.com/img/oIxHPV3M4i-320.jpeg&quot; width=&quot;1600&quot; height=&quot;912&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;Basically the magic here is:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Check &lt;code&gt;Use separate serial port PTT&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Check &lt;code&gt;Use RTS&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Set &lt;code&gt;Device&lt;/code&gt; to &lt;code&gt;/dev/cu.usbserial-1120&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first setting, &lt;code&gt;Use separate serial port PTT&lt;/code&gt; I believe enables &lt;code&gt;fldigi&lt;/code&gt; to use the new serial port
which the digirig hardware creates.&lt;/p&gt;
&lt;p&gt;The second setting, &lt;code&gt;Use RTS&lt;/code&gt; tells &lt;code&gt;fldigi&lt;/code&gt; to transmit a &lt;code&gt;Ready to Transmit Signal&lt;/code&gt; to the radio, which
actually keys up the radio and begins the transmission.&lt;/p&gt;
&lt;p&gt;The third setting, for the device, simply selects the digirig from the list of connected devices on
the mac. There are two varients listed for each device, with &lt;code&gt;cu&lt;/code&gt; or &lt;code&gt;tty&lt;/code&gt; prefixes.
e.g &lt;code&gt;/dev/cu.usbserial-1120&lt;/code&gt; or &lt;code&gt;/dev/tty.usbserial-1120&lt;/code&gt;. This &lt;a href=&quot;https://stackoverflow.com/questions/8632586/whats-the-difference-between-dev-tty-and-dev-cu-on-macos&quot;&gt;stack overflow post&lt;/a&gt;
explains the difference between the two. &lt;code&gt;cu&lt;/code&gt; appears to be used for outbound connections on linux
systems.&lt;/p&gt;
&lt;p&gt;I was able to successfully transmit over simplex with this setup, and am looking forward to trying
out more modes in a future iteration of the Puget Sound Digital Hams Net.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>New Site - From Jekyll to Eleventy</title>
		<link href="https://mattmakesmaps.com/blog/2023-10-19-site-migration/"/>
		<updated>2023-10-19T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2023-10-19-site-migration/</id>
		<content type="html">&lt;p&gt;I&#39;ve rebuilt this site using the &lt;a href=&quot;https://www.11ty.dev/&quot;&gt;Eleventy&lt;/a&gt; static site generator.&lt;/p&gt;
&lt;p&gt;The previous version ran on &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;jekyll&lt;/a&gt;, whoose out-of-the-box integration
with &lt;a href=&quot;https://pages.github.com/&quot;&gt;Github Pages&lt;/a&gt; felt revolutionary when I made the switch
from WordPress years ago.&lt;/p&gt;
&lt;p&gt;This site is based on the &lt;a href=&quot;https://github.com/11ty/eleventy-base-blog&quot;&gt;eleventy-base-blog&lt;/a&gt; template
(which appears to be an official release).&lt;/p&gt;
&lt;p&gt;Source files are hosted on the &lt;a href=&quot;https://github.com/mattmakesmaps/mattmakesmaps.github.com&quot;&gt;mattmakesmaps.github.com&lt;/a&gt;
project repo&#39;s &lt;code&gt;master&lt;/code&gt; branch, with &lt;a href=&quot;https://github.com/mattmakesmaps/mattmakesmaps.github.com/actions/runs/6556377877&quot;&gt;github actions&lt;/a&gt;
used to build and deploy content from the &lt;code&gt;gh-pages&lt;/code&gt; branch. At Tableau, I used Travis CI and JetBrains&#39; TeamCity for builds, and getting started with Github Actions felt very similar.&lt;/p&gt;
&lt;p&gt;With the old Jekyll content also being markdown entries, I&#39;ll be able to migrate as much or as
little of my old content as I choose over the next few weeks.&lt;/p&gt;
&lt;p&gt;Below is an example of a Github Actions run deploying the site. 35s for a free build
(since the repo is public) is perfect for my purposes.&lt;/p&gt;
&lt;p&gt;&lt;picture&gt;&lt;source type=&quot;image/webp&quot; srcset=&quot;https://mattmakesmaps.com/img/q4kJHwBnN7-320.webp 320w, https://mattmakesmaps.com/img/q4kJHwBnN7-600.webp 600w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;source type=&quot;image/jpeg&quot; srcset=&quot;https://mattmakesmaps.com/img/q4kJHwBnN7-320.jpeg 320w, https://mattmakesmaps.com/img/q4kJHwBnN7-600.jpeg 600w&quot; sizes=&quot;90vw, (min-width: 1280px) 1156px&quot;&gt;&lt;img alt=&quot;Screenshot showing the github actions build pipeline. Total runtime is 35 seconds.&quot; loading=&quot;lazy&quot; decoding=&quot;async&quot; src=&quot;https://mattmakesmaps.com/img/q4kJHwBnN7-320.jpeg&quot; width=&quot;600&quot; height=&quot;646&quot;&gt;&lt;/picture&gt;&lt;/p&gt;
&lt;p&gt;With regards to images, I wasn&#39;t familiar with the current standard
&lt;a href=&quot;https://developers.google.com/speed/webp&quot;&gt;webp format&lt;/a&gt; nor the best practice of generating multiple sized
versions of each image, optimizing loading performance across a variety of potential screen sizes.
The latter is refered as &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images&quot;&gt;responsive images&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The Eleventy framework handles this well out-of-the-box, allowing you generate custom export functions
that handle all aspects of output resolution and formats. I found the following to be a
great tutorial: &lt;a href=&quot;https://www.aleksandrhovhannisyan.com/blog/eleventy-image-plugin/&quot;&gt;https://www.aleksandrhovhannisyan.com/blog/eleventy-image-plugin/&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Using pg_dump with PostGIS Topology</title>
		<link href="https://mattmakesmaps.com/blog/2014-01-15-using-pg-dump-with-postgis-topology/"/>
		<updated>2014-01-15T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2014-01-15-using-pg-dump-with-postgis-topology/</id>
		<content type="html">&lt;p&gt;Using the &lt;a href=&quot;http://www.postgresql.org/docs/0.0/static/app-pgdump.html&quot;&gt;pg_dump&lt;/a&gt; utility is a standard
method for backing up a PostgreSQL database. Furthermore, limiting a &lt;code&gt;pg_dump&lt;/code&gt; export to a particular schema increases the portability of your geospatial data across different versions of PostGIS.
Since the PostGIS function signatures themselves are not copied in the data backup, data can be
backed up from a database under one version of PostGIS and restored into a new database of a differing version. &lt;a href=&quot;http://workshops.boundlessgeo.com/postgis-intro/backup.html&quot;&gt;Boundless&lt;/a&gt; has a great intro
guide to backing up and restoring PostGIS databases.&lt;/p&gt;
&lt;p&gt;Working with PostGIS Topologies however, requires a special tweak. &lt;!-- more --&gt; A typical PostGIS topology contains
data spread across three schemas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Topology &#39;Metadata&#39; schema, containing registered topologies and their layers.
Created by executing the statement &lt;code&gt;CREATE EXTENSION postgis_topology;&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Schema containing topology primitives. This is created as the result of a call to
&lt;a href=&quot;http://postgis.net/docs/CreateTopology.html&quot;&gt;CreateTopology()&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Schema containing topogeometry columns. These would be created by a call to
&lt;a href=&quot;http://postgis.net/docs/AddTopoGeometryColumn.html&quot;&gt;AddTopoGeometryColumn&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As an example, we&#39;ll have a PostGIS database called &lt;code&gt;parcels_postgis&lt;/code&gt; with the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Topology extension enabled&lt;/li&gt;
&lt;li&gt;Topology primitives are stored in the &lt;code&gt;parcel_topology&lt;/code&gt; schema.&lt;/li&gt;
&lt;li&gt;Topogeometry columns are stored in the &lt;code&gt;parcels&lt;/code&gt; schema&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Under this example, a call to &lt;code&gt;pg_dump&lt;/code&gt; looks like the following:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pg_dump &lt;span class=&quot;token parameter variable&quot;&gt;--schema&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;topology &lt;span class=&quot;token parameter variable&quot;&gt;--schema&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;parcels &lt;span class=&quot;token parameter variable&quot;&gt;--schema&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;parcel_topology &lt;span class=&quot;token parameter variable&quot;&gt;--file&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;parcel_data.sql parcels_postgis &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Restoring to a new db however, produces the following error:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;psql:test_data.sql:644: ERROR:  insert or update on table &lt;span class=&quot;token string&quot;&gt;&quot;layer&quot;&lt;/span&gt; violates foreign key constraint &lt;span class=&quot;token string&quot;&gt;&quot;layer_topology_id_fkey&quot;&lt;/span&gt;
DETAIL:  Key &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;topology_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; is not present &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; table &lt;span class=&quot;token string&quot;&gt;&quot;topology&quot;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is because the &lt;code&gt;pg_dump&lt;/code&gt; utility defaults to INSERT&#39;ing records into the &lt;code&gt;topology&lt;/code&gt; schema&#39;s
&lt;code&gt;layer&lt;/code&gt; table &lt;strong&gt;before&lt;/strong&gt; INSERT&#39;ing records into the &lt;code&gt;topology&lt;/code&gt; schema&#39;s &lt;code&gt;topology&lt;/code&gt; table. Since
the &lt;code&gt;layer&lt;/code&gt; table has a foreign key constraint with the &lt;code&gt;topology&lt;/code&gt; table, this can never work properly.&lt;/p&gt;
&lt;p&gt;One solution therefore, is to manually edit your &lt;code&gt;pg_dump&lt;/code&gt; output file to run &lt;code&gt;COPY&lt;/code&gt; commands onto
the &lt;code&gt;topology.topology&lt;/code&gt; table first, then the &lt;code&gt;topology.layer&lt;/code&gt; table second. A modified script with
the highlighted changes can be seen &lt;a href=&quot;https://github.com/mattmakesmaps/travis-postgis-test/blob/master/test_data.sql#L633-L651&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Configure PostGIS with Travis CI</title>
		<link href="https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/"/>
		<updated>2014-01-11T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/</id>
		<content type="html">&lt;p&gt;Thanks to a great presentation by &lt;a href=&quot;https://github.com/foundatron&quot;&gt;foundatron&lt;/a&gt; on the continuous
integration framework, &lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt;, I&#39;ve finally been motivated to push
for higher test coverage in my python projects.&lt;/p&gt;
&lt;p&gt;Some of these &lt;a href=&quot;https://github.com/mattmakesmaps/pgsql2gist&quot;&gt;projects&lt;/a&gt; require connectivity to a
PostGIS database for testing, and with Travis CI that process is extremely straightforward.
This post includes notes on configuring a Travis CI environment with PostgreSQL and PostGIS, then
loading that empty database with data.&lt;/p&gt;
&lt;h3 id=&quot;postgresql-postgis-versions&quot; tabindex=&quot;-1&quot;&gt;PostgreSQL/Postgis Versions &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; These versions are current as of &lt;strong&gt;January 2014&lt;/strong&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PostgreSQL: 9.1.11 by default, although you can &lt;a href=&quot;http://about.travis-ci.org/blog/2013-11-29-PostgreSQLql-92-93-now-available/&quot;&gt;explicitly declare&lt;/a&gt; 9.2 or 9.3.&lt;/li&gt;
&lt;li&gt;PostGIS: 2.1.1 r12113&lt;/li&gt;
&lt;li&gt;GEOS: 3.3.8&lt;/li&gt;
&lt;li&gt;PROJ: 4.8.0&lt;/li&gt;
&lt;li&gt;GDAL: 1.9.2&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- more --&gt;
&lt;h3 id=&quot;configuration&quot; tabindex=&quot;-1&quot;&gt;Configuration &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; For background reading on Travis CI, check out the &lt;a href=&quot;http://about.travis-ci.org/docs/user/getting-started/&quot;&gt;Getting Started&lt;/a&gt; and &lt;a href=&quot;http://about.travis-ci.org/docs/user/build-configuration/&quot;&gt;Build Configuration&lt;/a&gt; docs.&lt;/p&gt;
&lt;p&gt;As stated in the &lt;a href=&quot;http://about.travis-ci.org/docs/user/database-setup/#PostgreSQLQL&quot;&gt;database docs&lt;/a&gt;,
a Travis CI environment comes with PostgreSQL installed and ready-to-go. This also includes supporting
utilities such as: &lt;code&gt;psql&lt;/code&gt;,&lt;code&gt;pg_dump&lt;/code&gt;, and &lt;code&gt;pg_restore&lt;/code&gt;. Since we&#39;re using PostgreSQL 9.1+ and PostGIS 2.0+,
PostGIS can be installed using the &lt;code&gt;CREATE EXTENSION&lt;/code&gt; syntax.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;.travis.yml&lt;/code&gt; configuration file should now be modified to execute &lt;code&gt;psql&lt;/code&gt; calls in the
&lt;code&gt;before_script&lt;/code&gt; block to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create the database&lt;/li&gt;
&lt;li&gt;Create the PostGIS/PostGIS Topology Extensions&lt;/li&gt;
&lt;li&gt;Populate the database with test data. (See Below for Instructions)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A reference example &lt;code&gt;.travis.yml&lt;/code&gt; looks like this:&lt;/p&gt;
&lt;pre class=&quot;language-yml&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-yml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; python
&lt;span class=&quot;token key atrule&quot;&gt;python&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2.7&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# command to install dependencies&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pip install -r requirements.txt --use-mirrors&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# database creation&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;before_script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; psql &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;c &#39;create database travis_postgis;&#39; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;U postgres
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; psql &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;c &#39;CREATE EXTENSION postgis;&#39; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;U postgres &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;d travis_postgis
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; psql &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;c &#39;CREATE EXTENSION postgis_topology;&#39; &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;U postgres &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;d travis_postgis
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; psql &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;f test_data.sql &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;U postgres &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;d travis_postgis

&lt;span class=&quot;token comment&quot;&gt;# command to run tests&lt;/span&gt;
&lt;span class=&quot;token key atrule&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; nosetests &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;verbose&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;creating-test-data&quot; tabindex=&quot;-1&quot;&gt;Creating Test Data &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;pg_dump&lt;/code&gt; utility can be used to export the contents of a PostGIS database into a sql file,
suitable for loading into a newly created database by the Travis worker. Key to this is to have testing
data that you want to export inside of a separate schema (e.g. not in &lt;code&gt;public&lt;/code&gt;). With &lt;code&gt;pg_dump&lt;/code&gt; we can
specify an individual schema of data tables to export, otherwise we&#39;d be stuck with exporting potentially
incompatible PostGIS function signitures in addition to our data. Boundless has a
&lt;a href=&quot;http://workshops.boundlessgeo.com/postgis-intro/backup.html&quot;&gt;good article&lt;/a&gt; on backup strategies for PostGIS.&lt;/p&gt;
&lt;p&gt;From our source PostGIS database, export tables from our schema of interest (&lt;code&gt;test_data&lt;/code&gt;) into &lt;code&gt;test_data.sql&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ pg_dump &lt;span class=&quot;token parameter variable&quot;&gt;--schema&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;test_data travis_postgis &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; test_data.sql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As seen in the section above, the resulting sql file, &lt;code&gt;test_data.sql&lt;/code&gt; is then executed as part of the
Travis &lt;code&gt;before_script&lt;/code&gt; block, populating the testing database with geometries.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; I&#39;ve used the same name &lt;code&gt;travis_postgis&lt;/code&gt; for both my local database as well as the testing
database used by Travis CI. This isn&#39;t required.&lt;/p&gt;
&lt;h3 id=&quot;wrap-up&quot; tabindex=&quot;-1&quot;&gt;Wrap Up &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2014-01-11-configure-postgis-with-travis-ci/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Thanks to the combination of PostgreSQL&#39;s easy to use &lt;code&gt;CREATE EXTENSION&lt;/code&gt; syntax along with Travis CI&#39;s flexible build configurations, setting up a custom PostGIS database is fairly simple.&lt;/p&gt;
&lt;p&gt;An example repository with a &lt;code&gt;.travis.yml&lt;/code&gt; file and an example unit test can be found here: https://github.com/mattmakesmaps/travis-postgis-test&lt;/p&gt;
&lt;p&gt;This repository&#39;s Travis CI build log can be found here: https://travis-ci.org/mattmakesmaps/travis-postgis-test&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Creating Label Points With OpenStreetMap Data</title>
		<link href="https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/"/>
		<updated>2013-11-13T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/</id>
		<content type="html">&lt;h2 id=&quot;tl-dr&quot; tabindex=&quot;-1&quot;&gt;tl;dr &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Use a CTE to create a table of water polygons, aggregating&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- overlapping polygons sharing the same name&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; polys &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_DUMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_BUFFER&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geom &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; single_geom
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- Generate a name and label point for each feature&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- Generate an accurate area attribute by casting to geography&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_PointOnSurface&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;single_geom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
       ST_Area&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Geography&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Transform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;single_geom&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4326&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; area
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; polys&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;!-- more --&gt;
&lt;h2 id=&quot;overview&quot; tabindex=&quot;-1&quot;&gt;Overview &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.openstreetmap.org/&quot;&gt;OpenStreetMap&lt;/a&gt; is one the most amazing data projects I know of.
The breadth of high-quality, high-precision features contained with the OSM Planet never ceases
to impress me. That being said, the freedom of the OSM data model, which allows this high-level of
flexibility and openness, is not without its problems. Having participated in the OSM edit-a-thon,
I was inspired to deep dive into the OSM tagging ontology, and subsequent rendering workflows. As part
of this exploration, one of the major problems I&#39;ve run into was the generation of label points
derived from Open Street Map data.&lt;/p&gt;
&lt;p&gt;The following example is illustrative of the primary problem faced when generating label points,
overlapping geometries. The SQL statement below returns all features within an &lt;a href=&quot;http://imposm.org&quot;&gt;imposm&lt;/a&gt;
database&#39;s &lt;code&gt;osm_new_waterareas&lt;/code&gt; table named, &#39;Lake Chelan&#39;. Three geometries are returned, one
representing the entire lake, and two others representing northern and southern sections of the lake.
All three share a name of, &lt;code&gt;Lake Chelan&lt;/code&gt;, but two are of type &lt;code&gt;water&lt;/code&gt;, and one is of type &lt;code&gt;reservoir&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; osm_id
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
&lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lake Chelan&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    name     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;   &lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt;    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;  osm_id   
&lt;span class=&quot;token comment&quot;&gt;-------------+-----------+-----------&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; reservoir &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;446718&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; water     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;135297050&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; water     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;52045429&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Click the map below to view each of the three geometries.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gist 03d7f78a1591971ed2d8 chelan.geojson&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Rendering label points using PostGIS&#39;s &lt;a href=&quot;http://postgis.org/docs/ST_PointOnSurface.html&quot;&gt;ST_PointOnSurface()&lt;/a&gt;
function would yield three separate points, as illustrated below. I however, would like only a single
label point for each feature.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gist 9cf8b49844cb43dfae81 chelan.geojson&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;step-by-step&quot; tabindex=&quot;-1&quot;&gt;Step By Step &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In addition to a single label point, I&#39;d also like to attribute that label point with an area value,
to be used as a toggle for display at varying zoom levels.&lt;/p&gt;
&lt;p&gt;The query at the beginning of the post generates this output table. Let&#39;s walk through the major parts
that make up the &lt;code&gt;single_geom&lt;/code&gt; parameter, step-by-step.&lt;/p&gt;
&lt;h3 id=&quot;step-one-st-collect&quot; tabindex=&quot;-1&quot;&gt;Step One: ST_Collect() &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&quot;http://postgis.net/docs/manual-1.4/ST_Collect.html&quot;&gt;ST_Collect()&lt;/a&gt; in PostGIS is an aggregate
function. Just as a &lt;code&gt;GROUP BY&lt;/code&gt; clause can be used to aggregate features sharing a common attribute
value, &lt;code&gt;ST_Collect()&lt;/code&gt; can be used to group geometries. In this case, we&#39;ll use it to group
geometries that are associated with the same name. See the code snippet below.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Execute ST_Collect() Function, creating a MULTIPOLYGON&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- for all features sharing a common name.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; collected &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lake Chelan&#39;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_GeometryType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_NRings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; collected&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;-- Results&lt;/span&gt;
    name     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_geometrytype &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_nrings 
&lt;span class=&quot;token comment&quot;&gt;-------------+-----------------+-----------&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_MultiPolygon &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This produces the following MULTIPOLYGON result.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gist 8d4cdbc307deb6d7977f&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;step-two-st-buffer&quot; tabindex=&quot;-1&quot;&gt;Step Two: ST_Buffer() &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;a href=&quot;http://www.postgis.org/docs/ST_Buffer.html&quot;&gt;ST_Buffer()&lt;/a&gt; function is used as somewhat of a hack.
It has the special quality of creating from its inputs, a new OGC-compliant geometry. This means that
when given a set of input geometries, and a &#39;0&#39; buffer-distance value, we are essentially left with a
geometry clean geometry that represents the outer-most ring of our MULTIPOLYGON created during the
&lt;code&gt;ST_Collect()&lt;/code&gt; operation.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Add a 0-distance buffer to our above result, creating a&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- new single polygon representing the outer ring.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; coll_buff &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_Buffer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lake Chelan&#39;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_GeometryType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_NRings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; coll_buff&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;-- Results&lt;/span&gt;
    name     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_geometrytype &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_nrings 
&lt;span class=&quot;token comment&quot;&gt;-------------+-----------------+-----------&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we&#39;re really looking good. We&#39;ve got a single polygon that represents our water feature.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gist b76fd3997f99086f6d24&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;I could run &lt;code&gt;ST_PointOnSurface()&lt;/code&gt; against the geometry above, and return a single label point. So what
more needs to be done? The example above works because all records within my OSM planet file with water
features named &lt;code&gt;Lake Chelan&lt;/code&gt; happen to occur in the same spot. It&#39;s a very unique name. What happens
when I run the same query against a more common name, &lt;code&gt;Twin Lakes&lt;/code&gt;?&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Re-execute with a much more common name&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; coll_buff &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_Buffer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Twin Lakes&#39;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_GeometryType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_NRings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; coll_buff&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;-- Our results generate a MULTIPOLYGON, not a POLYGON&lt;/span&gt;
    name    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_geometrytype &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_nrings 
&lt;span class=&quot;token comment&quot;&gt;------------+-----------------+-----------&lt;/span&gt;
 Twin Lakes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_MultiPolygon &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;272&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A single record is created, however it is the aggregate MULTIPOLYGON of all features in the globe
that happen to be named &lt;code&gt;Twin Lakes&lt;/code&gt;. Executing &lt;code&gt;ST_PointOnSurface()&lt;/code&gt; would return a single point
geometry, not the 272 unique label points we need.&lt;/p&gt;
&lt;h3 id=&quot;step-three-st-dump&quot; tabindex=&quot;-1&quot;&gt;Step Three: ST_Dump() &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Now that our &lt;code&gt;ST_Collect()&lt;/code&gt; + &lt;code&gt;ST_Buffer()&lt;/code&gt; combo has given us a mixed bag of POLYGON and
MULTIPOLYGON geometries, it&#39;s explode these guys into separate features. For that, we&#39;ll be using
the &lt;a href=&quot;http://postgis.refractions.net/docs/ST_Dump.html&quot;&gt;ST_Dump()&lt;/a&gt; function. In the example of our
Lake Chelan polygon, &lt;code&gt;ST_Dump()&lt;/code&gt; will create for us our same polygon. However, for our example of
the &lt;code&gt;Twin Lakes&lt;/code&gt; MULTIPOLYGON with 272 rings, we&#39;ll get back 272 unique records. This will allow us
to create a label point for each instance of &lt;code&gt;Twin Lakes&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ST_Dump is a bit tricky in that it doesn&#39;t simply return the exploded geom (MULTIPOLYGON --&amp;gt; POLYGON),
but rather a special &lt;a href=&quot;http://postgis.net/docs/geometry_dump.html&quot;&gt;geometry_dump&lt;/a&gt; data type. From that
resulting datatype, we&#39;ll select out the &lt;code&gt;geom&lt;/code&gt; field, giving us our POLYGON.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- ST_Dump - Lake Chelan Example&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- NOTE: Wrapping ST_Dump() call in parentheses, and returning the geom&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- field from the resulting geometry_dump.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; coll_buff &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Dump&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Buffer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geom &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lake Chelan&#39;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_GeometryType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_NRings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; coll_buff&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;-- Returns a single feature as expected.&lt;/span&gt;
    name     &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_geometrytype &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_nrings 
&lt;span class=&quot;token comment&quot;&gt;-------------+-----------------+-----------&lt;/span&gt;
 Lake Chelan &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;


&lt;span class=&quot;token comment&quot;&gt;-- ST_Dump - Twin Lakes Example&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; coll_buff &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Dump&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Buffer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geom &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Twin Lakes&#39;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_GeometryType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_NRings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; coll_buff&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;-- Returns each of the 272 rings of the MULTIPOLYGON as&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- unique polygon features.&lt;/span&gt;
    name    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_geometrytype &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; st_nrings 
&lt;span class=&quot;token comment&quot;&gt;------------+-----------------+-----------&lt;/span&gt;
 Twin Lakes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
 Twin Lakes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
 Twin Lakes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
 Twin Lakes &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; ST_Polygon      &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;         &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- NOTE: Selection of results shown.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;step-four-generate-an-area-attribute&quot; tabindex=&quot;-1&quot;&gt;Step Four: Generate An Area Attribute &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In order to have some type of filtration attribute to filter the display of our labels
at different zoom levels, we&#39;ll be calculating an area attribute. Since our data are in
the Spherical Mercator projection common to all web maps, we have inherit problems
generating accurate area calculations directly. One solution to this is to CAST our
geometries into a PostGIS &lt;a href=&quot;http://workshops.boundlessgeo.com/postgis-intro/geography.html&quot;&gt;geography&lt;/a&gt;
data type.&lt;/p&gt;
&lt;p&gt;As a prerequisite to the Geometry --&amp;gt; Geography cast, we need to first use
&lt;a href=&quot;http://www.postgis.org/docs/ST_Transform.html&quot;&gt;ST_Transform&lt;/a&gt; to convert our data from the
Spherical Mercator projection to WGS84 Lat/Lng.&lt;/p&gt;
&lt;p&gt;The area calculation snippet looks like this&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;ST_Area&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Geography&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Transform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;single_geom&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4326&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; area&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And wrapped into our larger label point SQL statement, looks like this.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; polys &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_DUMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_BUFFER&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Collect&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geom &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; single_geom
    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; osm_new_waterareas
    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;Lake Chelan&#39;&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;GROUP&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; name
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- Generate a name and label point for each feature&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- Generate an accurate area attribute by casting to geography&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ST_PointOnSurface&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;single_geom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
       ST_Area&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Geography&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Transform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;single_geom&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4326&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; area
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; polys&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Just to drive home the importance of accurate area calculations, our call using the CAST
to geography returns a value of 132.028 square kilometers, while using the raw Spherical
Mercator geometry returns an area value of 295.106 square kilometers! Our geography-based
area calculation is much more in line with the 135 square kilometer value
&lt;a href=&quot;http://en.wikipedia.org/wiki/Lake_Chelan&quot;&gt;reported by wikipedia&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;wrap-up&quot; tabindex=&quot;-1&quot;&gt;Wrap-up &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;And finally, after all that effort, we get the point shown below.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;gist cb1f750979bbcf40a8e5&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;speeding-up-with-indexes&quot; tabindex=&quot;-1&quot;&gt;Speeding Up With Indexes &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-11-13-creating-label-points-with-openstreetmap-data/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;While this exercise is extremely fast on our small test dataset, scaling this up to an
entire imposm OSM planet import is another thing entirely. To facilitate this process,
both spatial and non-spatial indexes can be utilized.&lt;/p&gt;
&lt;p&gt;I created a partial btree index on the name column, a functional index on the transformation
of geometric data to EPSG 4326, and a gist index already existed on the geometry column
as part of the imposm import.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Create a partial index on names that are not null.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INDEX&lt;/span&gt; idx_waterareas_name_partial &lt;span class=&quot;token keyword&quot;&gt;ON&lt;/span&gt; osm_new_waterareas &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; name &lt;span class=&quot;token operator&quot;&gt;IS&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;-- Create a functional index on the transformation&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INDEX&lt;/span&gt; idx_waterareas_4326 &lt;span class=&quot;token keyword&quot;&gt;ON&lt;/span&gt; osm_new_waterareas &lt;span class=&quot;token keyword&quot;&gt;USING&lt;/span&gt; gist&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ST_Transform&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;geometry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4326&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This process, after applying indexes, took about 5.4 minutes to create. That is, to create a global
set of label points for ~185,000 named water features within the OSM planet file, with both a name and
dynamically calculated area attribute. This test was performed on modest desktop hardware, on a PostGIS
instance that was already hot (had been running, been used for querying water area data as part
of this experiment).&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>TileStache-Links-Roundup</title>
		<link href="https://mattmakesmaps.com/blog/2013-10-15-tilestache-links-roundup/"/>
		<updated>2013-10-15T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-10-15-tilestache-links-roundup/</id>
		<content type="html">&lt;p&gt;I&#39;m giving a presentation at this year&#39;s &lt;a href=&quot;http://cugos.org/events/2013/10/16/fall-fling/&quot;&gt;CUGOS Fall Fling Bling&lt;/a&gt;, on &lt;a href=&quot;http://tilestache.org&quot;&gt;TileStache&lt;/a&gt;. The list below are a series of interesting links I&#39;ve found regarding TileStache, or Vector Tiles in general.&lt;/p&gt;
&lt;h2 id=&quot;mind-of-migurski&quot; tabindex=&quot;-1&quot;&gt;Mind of Migurski &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-15-tilestache-links-roundup/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://mike.teczno.com/notes/vector-tile-rendering-numbers.html&quot;&gt;Tiled Vector Update, with Math&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mike.teczno.com/notes/postgreslessness-mapnik-vectiles.html&quot;&gt;the libery of postgreslessness: tiled vectors in mapnik&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mike.teczno.com/notes/tilestache.html&quot;&gt;Presenting TileStache&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;nelson-minar-vector-tiles-notes&quot; tabindex=&quot;-1&quot;&gt;Nelson Minar Vector Tiles Notes &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-15-tilestache-links-roundup/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/NelsonMinar/vector-river-map&quot;&gt;Map of American Rivers&lt;/a&gt;: &lt;strong&gt;NOTE:&lt;/strong&gt; This is a fantastic tutorial.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://bl.ocks.org/NelsonMinar/5851197&quot;&gt;TopoJSON Vector Maps from OSM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://vimeopro.com/openstreetmapus/state-of-the-map-us-2013/video/68099164&quot;&gt;TopoJSON: A Smaller GeoJSON with Some Neat Tricks&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;data&quot; tabindex=&quot;-1&quot;&gt;Data &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-15-tilestache-links-roundup/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://openstreetmap.us/~migurski/vector-datasource/&quot;&gt;OSM US Vector Tiles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;My own slides from the Fall Fling can be found &lt;a href=&quot;https://speakerdeck.com/mattmakesmaps/tilestache-more-then-youre-granddads-tilecache-server&quot;&gt;here&lt;/a&gt;. An introductory blog post on rendering TopoJSON with TileStache can be found, &lt;a href=&quot;http://mattmakesmaps.com/blog/2013/10/09/tilestache-rendering-topojson/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>TileStache: Generate [Topo|Geo]JSON Vector Tiles</title>
		<link href="https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/"/>
		<updated>2013-10-09T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/</id>
		<content type="html">&lt;p&gt;Vector tiles are simply tiled representations of geographic data, much like raster tiles
used to power typical web maps such as OpenStreetMap. They differ from traditional
raster tiles however in that instead being an image, they actually contain the
geographic coordinates and attributes of the features that exist within their bounding boxes.
Vector tiles can be used for a variety of different rendered outputs within a modern web-mapping
application. One examples can include serving as an intermediate step in the processing of
raster tiles. This approach is adopted by Mapbox, who have defined their own
&lt;a href=&quot;https://www.mapbox.com/blog/vector-tiles/&quot;&gt;mapnik-vector-tile&lt;/a&gt; spec. This allows for amazing
styling possibilities, allowing raster tiles to be generated with different styles quickly and
efficiently based on the same dataset. Another approach relies on transmitting vector data directly
to the client, where client-side libs render data as SVGs directly in the browser. &lt;a href=&quot;http://d3js.org&quot;&gt;D3.js&lt;/a&gt;
is a JavaScript library that can do this just this, as illustrated by &lt;a href=&quot;http://bl.ocks.org/svmatthews/6081504&quot;&gt;Sam Matthews&lt;/a&gt;. Now that we know what they&#39;re good for, how can we take our own local geographic data, and render our own?&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;&lt;a href=&quot;http://tilestache.org&quot;&gt;TileStache&lt;/a&gt; is a Tiled Mapping Server written in Python. The core committer on the project
is &lt;a href=&quot;http://mike.teczno.com&quot;&gt;Michael Migurski&lt;/a&gt;, formerly of &lt;a href=&quot;http://stamen.com&quot;&gt;Stamen Design&lt;/a&gt; and now CTO of
&lt;a href=&quot;http://www.codeforamerica.org&quot;&gt;Code for America&lt;/a&gt;. He&#39;s blogged extensively about his development of
the TileStache project to incorporate both use-cases illustrated above
(&lt;a href=&quot;http://mike.teczno.com/notes/postgreslessness-mapnik-vectiles.html&quot;&gt;pipeline to raster tiles via mapnik&lt;/a&gt;,
&lt;a href=&quot;http://mike.teczno.com/notes/vector-tile-rendering-numbers.html&quot;&gt;client-side rendering&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;I&#39;ve been reviewing the source code for this project for the past few weeks and have been impressed at the accessibility
of the code to a novice Python developer such as myself. In any event, I&#39;d like to use this post to drop some
quick notes on how to get things up and running.&lt;/p&gt;
&lt;h2 id=&quot;prerequisites&quot; tabindex=&quot;-1&quot;&gt;Prerequisites &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TileStache Installed With Dependencies&lt;/li&gt;
&lt;li&gt;PostGIS Installed&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;data&quot; tabindex=&quot;-1&quot;&gt;Data &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The dataset I imported for rendering is known as &#39;processed_p&#39;, which can be downloaded &lt;a href=&quot;http://openstreetmapdata.com/data/land-polygons&quot;&gt;here&lt;/a&gt;. This is the land dataset used in the OpenStreetMap basemap. I picked this dataset because it is highly detailed, large (365 MB), and projected in spherical mercator. This is a perfect example of a dataset in which you would really want to have a server spraying out just those specific slices of data (tiles) a user has requested, from the larger whole.&lt;/p&gt;
&lt;h2 id=&quot;process&quot; tabindex=&quot;-1&quot;&gt;Process &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Create a PostGIS Database, &#39;ts_data&#39;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ created ts_data
$ psql &lt;span class=&quot;token parameter variable&quot;&gt;-d&lt;/span&gt; ts_data
ts_data&lt;span class=&quot;token comment&quot;&gt;# CREATE EXTENSION postgis;&lt;/span&gt;
CREATE EXTENSION
&lt;span class=&quot;token assign-left variable&quot;&gt;ts_data&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;# CREATE SCHEMA osm;&lt;/span&gt;
CREATE SCHEMA&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Load processed_p Shapefile into PostGIS&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;NOTE: See the excellent shp2pgsql/pgsql2shp cheat sheet by &lt;a href=&quot;http://www.bostongis.com/pgsql2shp_shp2pgsql_quickguide_20.bqg&quot;&gt;BostonGIS&lt;/a&gt;&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# NOTE YMMV, MAY NEED TO ADD ADDITIONAL PSQL CONNECTION PARAMS. SEE &#39;$psql --help&#39;&lt;/span&gt;
$ shp2pgsql &lt;span class=&quot;token parameter variable&quot;&gt;-I&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;900913&lt;/span&gt; land_polygons.shp osm.land_polygons_split &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; psql &lt;span class=&quot;token parameter variable&quot;&gt;-d&lt;/span&gt; ts_data &lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Create a TileStache Config&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;TileStache relies on a user-defined configuration file to define a layer, accessible by a client.
In this context, a layer is essentially a combination of a backing dataset (e.g. shapefile, MBTiles,
PostGIS database, etc.) and instructions on how those data should be rendered (e.g. Vector Tiles, UTF-GRID, Mapnik, etc.)&lt;/p&gt;
&lt;p&gt;An example configuration file can be found &lt;a href=&quot;https://github.com/mattmakesmaps/TileStache-Experiment/blob/master/config_files/topojson.cfg#L84-L99&quot;&gt;here&lt;/a&gt;. I&#39;ve highlighted the relevant block, which is excerpted
below. This example uses the VecTiles provider (&lt;a href=&quot;http://tilestache.org/doc/TileStache.Goodies.VecTiles.html&quot;&gt;docs&lt;/a&gt;),
which requires a PostGIS backing store, and produces tiles in geojson, topojson, or Mapnik Vector Tile (MVT) format.
Comments have been added below for clarity.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token string-property property&quot;&gt;&quot;osm-processed_p1&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Layer Name&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Sets ACCESS-CONTROL-ALLOW-ORIGIN header to &quot;*&quot;&lt;/span&gt;
    &lt;span class=&quot;token string-property property&quot;&gt;&quot;allowed origin&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;token string-property property&quot;&gt;&quot;provider&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;class&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;TileStache.Goodies.VecTiles:Provider&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// PostGIS Connection Info&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;kwargs&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
            &lt;span class=&quot;token string-property property&quot;&gt;&quot;dbinfo&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token string-property property&quot;&gt;&quot;host&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;localhost&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string-property property&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;matt&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token string-property property&quot;&gt;&quot;database&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ts_data&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// An array of queries for each zoom level.&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// One query == Used for All Zooms&lt;/span&gt;
            &lt;span class=&quot;token string-property property&quot;&gt;&quot;queries&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; 
                &lt;span class=&quot;token string&quot;&gt;&quot;SELECT gid, geom AS __geometry__ FROM osm.land_polygons_split&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Start the Server.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;TileStache comes pre-canned with it&#39;s own simple development server. If installing TileStache from a python package
manager, It can be accessed from the command line via &lt;code&gt;$ tilestache-server.py&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The server should now be accessible via &lt;a href=&quot;http://127.0.0.1:8080/&quot;&gt;http://127.0.0.1:8080/&lt;/a&gt;. &amp;quot;TileStache bellows hello.&amp;quot;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Request a Tile.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;From the &lt;a href=&quot;http://tilestache.org/doc/&quot;&gt;API docs&lt;/a&gt;: &amp;quot;TileStache URLs are based on a Google Maps-like scheme&amp;quot;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/{layer name}/{zoom}/{column}/{row}.{extension}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Utilizing the layer name referenced in the configuration example above, &amp;quot;osm-processed_p1&amp;quot;, a tile request would look like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http://127.0.0.1:8080/osm-processed_p1/9/147/196.topojson #TopoJSON
http://127.0.0.1:8080/osm-processed_p1/9/147/196.json #GeoJSON
http://127.0.0.1:8080/osm-processed_p1/9/147/196.mvt # Mapnik Vector Tile
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looking at the HTTP requests above, we can see that we&#39;re calling on the same layer, e.g. the same backing datastore,
but rendering those same data into three different output formats. Pretty neat.&lt;/p&gt;
&lt;h2 id=&quot;wrapping-up&quot; tabindex=&quot;-1&quot;&gt;Wrapping Up &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-10-09-tilestache-rendering-topojson/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;TileStache vector tiles can be rendered in any number of client side JS libraries that support GeoJSON or TopoJSON.
Pushing the above requested TopoJSON tile to github, we can view the rendered geometries with their attributes.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gist 6896905 s00_9_147_196.topojson
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;TileStache provides an easy-to-use point of entry for vector tiles. In a later post I&#39;ll go over some of the profiling
experiments I&#39;ve been running, using TileStache&#39;s dynamic line simplification, and it&#39;s affects on file size as well as
the aesthetic affects on representations of these geometries.&lt;/p&gt;
&lt;p&gt;I&#39;ll also be writing out the work I did extending TileStache to support calls to the &lt;a href=&quot;http://labs.giphy.com&quot;&gt;Giphy Labs API&lt;/a&gt;: &lt;a href=&quot;http://mattmakesmaps.github.io/TileStache-GiphyAPI-Demo/&quot;&gt;http://mattmakesmaps.github.io/TileStache-GiphyAPI-Demo/&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Quickstart GIS Setup on Ubuntu Linux 12.04 LTS</title>
		<link href="https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/"/>
		<updated>2013-08-26T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/</id>
		<content type="html">&lt;p&gt;I had to recently setup a clean Ubuntu 12.04 LTS workstation for GIS
data processing. For the simplicity and speed, I decided to go with
packaged versions of many of the required GIS software. Many of the
packages are derived from the &lt;a href=&quot;https://launchpad.net/~ubuntugis/+archive/ubuntugis-unstable&quot;&gt;ubuntugis-unstable&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;What follows below are a blow-by-blow of my installation notes
grouped by software package. Either code snippets or links to relevant
blog posts.&lt;!-- More --&gt;&lt;/p&gt;
&lt;p&gt;This is certainly only a high-level guide. If anyone has any other
suggestions or alternatives, please feel free to list them.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The order of these installs reflects the actual order in
which I installed them.&lt;/p&gt;
&lt;h2 id=&quot;non-gis-essentials&quot; tabindex=&quot;-1&quot;&gt;Non-GIS Essentials &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;install-ssh&quot; tabindex=&quot;-1&quot;&gt;Install SSH &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Secure_Shell&quot;&gt;SSH&lt;/a&gt; or Secure Shell,
is essential for remote server administration.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$ sudo apt-get install openssh-server&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;increase-history-size&quot; tabindex=&quot;-1&quot;&gt;Increase History Size &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The default history size is pretty low. Increasing the size allows us
to do search for that oft-used terminal command right when you need it
most. What was the name of that server I ssh&#39;d into last month?
Piping history to grep can do the trick. &lt;code&gt;$ history | grep -i &amp;quot;ssh&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;vim&lt;/span&gt; ~/.bashrc
&lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;HISTSIZE&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10000&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;HISTFILESIZE&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;python-virtual-environments&quot; tabindex=&quot;-1&quot;&gt;Python Virtual Environments &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Used this &lt;a href=&quot;https://gist.github.com/panuta/3075882&quot;&gt;awesome gist&lt;/a&gt; by
github user &lt;a href=&quot;https://github.com/panuta&quot;&gt;panuta&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Didn&#39;t follow, but a good reference: &lt;a href=&quot;http://askubuntu.com/questions/244641/how-to-set-up-and-use-a-virtual-python-environment-in-ubuntu&quot;&gt;http://askubuntu.com/questions/244641/how-to-set-up-and-use-a-virtual-python-environment-in-ubuntu&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;apache&quot; tabindex=&quot;-1&quot;&gt;Apache &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;$ sudo apt-get install apache2
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;gis-packages&quot; tabindex=&quot;-1&quot;&gt;GIS Packages &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id=&quot;connect-to-the-ubuntugis-unstable-ppa&quot; tabindex=&quot;-1&quot;&gt;Connect to the UbuntuGIS-Unstable PPA &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In order to access many of these packages, we need to connect the
system to the UbuntuGIS-Unstable PPA.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
$ sudo apt-get update
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;gdal-fiona&quot; tabindex=&quot;-1&quot;&gt;GDAL/Fiona &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;GDAL/OGR are the defacto Open Source GIS swiss army knife.
&lt;a href=&quot;https://github.com/sgillies/Fiona&quot;&gt;Fiona&lt;/a&gt; provides easy-to-use
Python bindings for use in your projects.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo apt-get install libgdal-dev gdal-bin
$ workon gis-base
$ sudo apt-get install python2.7-dev
$ pip install Fiona
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;postgres-postgis&quot; tabindex=&quot;-1&quot;&gt;Postgres/PostGIS &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The ubuntu unstable repository provides pre-packaged binaries combining both Postgres and Postgis.&lt;/p&gt;
&lt;p&gt;As of August 2013, GDAL version 1.10 for some reason doesn&#39;t include libgdal1, replaced by libgdalh. See: &lt;a href=&quot;http://lists.osgeo.org/pipermail/ubuntu/2013-July/000757.html&quot;&gt;http://lists.osgeo.org/pipermail/ubuntu/2013-July/000757.html&lt;/a&gt;
This appearently is causing some issues with packages installations, including Postgres/PostGIS. The steps below appear to work.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo apt-get install libgdal1-dev
$ sudo apt-get install postgresql-9.1-postgis-2.0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you need any of the postgis util scripts, e.g. &lt;code&gt;postgres_restore.pl&lt;/code&gt; used for restoring a postgres database (across differing versions
of postgis), I believe the only way to get these is by making from source.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ sudo apt-get install proj
$ wget http://download.osgeo.org/postgis/source/postgis-2.0.3.tar.g
$ tar -zxvf postgis-2.0.3.tar.gz
$ cd postgis-2.0.3/
$ ./configure
$ make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, if you need to change your Postgresql data dir to another
disk, this guide provides good advice: &lt;a href=&quot;http://www.whiteboardcoder.com/2012/04/change-postgres-datadirectory-folder.html&quot;&gt;http://www.whiteboardcoder.com/2012/04/change-postgres-datadirectory-folder.html&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;imposm-2-5-0&quot; tabindex=&quot;-1&quot;&gt;Imposm 2.5.0 &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If you&#39;re rendering OSM data, imposm is one of the fastest ways
to get data from an OSM Planet Extract into PostGIS.&lt;/p&gt;
&lt;p&gt;I followed the instructions within the &lt;a href=&quot;http://imposm.org/docs/imposm/latest/install.html#requirements&quot;&gt;Imposm documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Note: Installed imposm directly into my virtualenv &amp;quot;gis-base&amp;quot;&lt;/p&gt;
&lt;h3 id=&quot;quantum-gis&quot; tabindex=&quot;-1&quot;&gt;Quantum GIS &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-08-26-quickstart-gis-setup-on-ubuntu-linux-12-dot-04-lts/&quot;&gt;#&lt;/a&gt;&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; qgis&lt;/code&gt;&lt;/pre&gt;
</content>
	</entry>
	
	<entry>
		<title>MapBox + Github = Free and Fast Web Maps</title>
		<link href="https://mattmakesmaps.com/blog/2013-07-17-mapbox-plus-github-equals-free-and-fast-web-maps/"/>
		<updated>2013-07-17T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-07-17-mapbox-plus-github-equals-free-and-fast-web-maps/</id>
		<content type="html">&lt;p&gt;With the announcement of Github&#39;s awesome support for &lt;a href=&quot;http://www.mapbox.com/blog/github-mapbox-maps/&quot;&gt;direct geojson renderingg&lt;/a&gt;,
folks can deploy an embeddable web map with a single git commit and push. This got me
thinking about the potential of github, specifically &lt;a href=&quot;http://pages.github.com/&quot;&gt;github pages&lt;/a&gt;,
as a vehicle for the display of more customized web mapping applications. The result of that
experiment is &lt;a href=&quot;http://aknativenamesatlas.com&quot;&gt;aknativenamesatlas.com&lt;/a&gt;. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;I deployed the initial draft of this site in a few hours, thanks entirely not only to
the power of MapBox and Github&#39;s hosting infrastructure, but also to the easy-to-use
&lt;a href=&quot;http://www.mapbox.com/map-sites/&quot;&gt;mapping templates&lt;/a&gt; provided by MapBox.&lt;/p&gt;
&lt;p&gt;This blog series will attempt to illustrate some of the major steps involved in the
process of deploying this map. The general process however, is as follows.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Style cartographic layers via TileMill, upload to MapBox.&lt;/li&gt;
&lt;li&gt;Create composite map of individual operation layers plus a base within MapBox.&lt;/li&gt;
&lt;li&gt;Fork MapBox&#39;s dc-properties-template via github.&lt;/li&gt;
&lt;li&gt;Edit forked repository to point to my layers of interest.&lt;/li&gt;
&lt;li&gt;Add CNAME record for custom URL to forked repository.&lt;/li&gt;
&lt;li&gt;Configure DNS to route custom domain name to github pages.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This first post will cover the cartography, and more importantly, the on-the-fly compositing of
layers.&lt;/p&gt;
&lt;h1 id=&quot;cartography-and-compositing&quot; tabindex=&quot;-1&quot;&gt;Cartography &amp;amp; Compositing &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-07-17-mapbox-plus-github-equals-free-and-fast-web-maps/&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;p&gt;The primary tool used to create the cartographic look and feel of the individual data layers is
&lt;a href=&quot;http://www.mapbox.com/tilemill/&quot;&gt;TileMill&lt;/a&gt;. TileMill is a desktop cartographic design studio, allowing you to
load your own datasets from a variety of spatial formats (SHP, SpatialLite, PostGIS), and style via a CSS-like
language, &lt;a href=&quot;http://www.mapbox.com/tilemill/docs/manual/carto/&quot;&gt;CartoCSS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I&#39;ll gloss over the details for styling maps in in TileMill, but they&#39;ve got a great
&lt;a href=&quot;http://www.mapbox.com/tilemill/docs/crashcourse/introduction/&quot;&gt;quick-start guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For my site, I ended up creating two projects in TileMill, one for each operational layer present in the final
map. The first layer represents &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_points/page.html&quot;&gt;place names&lt;/a&gt;
, symbolized as points. The second layer depicts &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_lines/page.html&quot;&gt;language regions&lt;/a&gt;
, symbolized as lines, but the geometry are in actuality polygons (required for the display of attribute information via a hover event).&lt;/p&gt;
&lt;p&gt;Splitting these operational layers into separate projects in TileMill, and conversely separate web maps when uploaded to MapBox, allows
us to mix and match these layers at will. Specifically, the &lt;a href=&quot;http://www.mapbox.com/developers/api/#Map.resources&quot;&gt;MapBox REST API&lt;/a&gt;
allows us to composite or layer individual maps into a single-tile, on-the-fly. If you&#39;re head hasn&#39;t been exploded, allow me to illustrate.&lt;/p&gt;
&lt;p&gt;The map on &lt;a href=&quot;http://aknativenamesatlas.com&quot;&gt;aknativenamesatlas.com&lt;/a&gt; is a composite of multiple layers. A basemap, provided by mapbox, as well as two operational layers (a point layer and a line layer).&lt;/p&gt;
&lt;p&gt;A &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.map-9ipoh344/6/5/16.png&quot;&gt;single tile&lt;/a&gt; from this map looks like this:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The URL is as follows: &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.map-9ipoh344/6/5/16.png&quot;&gt;http://a.tiles.mapbox.com/v3/mattmakesmaps.map-9ipoh344/6/5/16.png&lt;/a&gt;. Note the &lt;code&gt;mattmakesmaps.map-9ipoh3441&lt;/code&gt; section of the URL. This is a combination of my user account, &lt;code&gt;mattmakesmaps&lt;/code&gt; and the unique map id. This identifier indicates that I&#39;m requesting the tile representing this specific map, again, a composite of multiple layers.&lt;/p&gt;
&lt;p&gt;We can however, query individual layers that make up this map. For example, the lines layer specifically has a URL endpoint of &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_lines/6/5/16.png&quot;&gt;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_lines/6/5/16.png&lt;/a&gt;. It looks like this.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Similarly, with the points layer: &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_points/6/5/16.png&quot;&gt;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_points/6/5/16.png&lt;/a&gt;. NOTE: You&#39;ll have to squint to see the points. They don&#39;t show up very well with the black on dark blue background. OR, you can open the tile link above in a new tab.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;The real magic comes when we composite these individual layers together, on-the-fly. From the &lt;a href=&quot;http://www.mapbox.com/developers/api/#Map.resources&quot;&gt;docs&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;By joining multiple ids with commas into a single :map parameter you can access the MapBox Hosting compositing API to layer multiple tile images, UTFgrids or aggregate the TileJSON of multiple maps into a single map.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;That looks something like this &lt;a href=&quot;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_lines,mattmakesmaps.language_points/6/5/16.png&quot;&gt;http://a.tiles.mapbox.com/v3/mattmakesmaps.language_lines,mattmakesmaps.language_points/6/5/16.png&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Pretty cool. You can even flip the z-index in which the layers are composited by simply re-arranging their position in the URL.&lt;/p&gt;
&lt;p&gt;That&#39;s it for now. The next post will cover how to fork Mapbox&#39;s DC-Properties template, allowing us to visualize our maps, accessible via github pages.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Fixing ArcGIS 10.1 Numpy Import Error From Python Console</title>
		<link href="https://mattmakesmaps.com/blog/2013-07-10-fixing-arcgis-10-dot-1-python-console-numpy-import-error/"/>
		<updated>2013-07-10T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-07-10-fixing-arcgis-10-dot-1-python-console-numpy-import-error/</id>
		<content type="html">&lt;p&gt;At my current employer, we have four Windows 7 64-bit workstations, all running ArcGIS 10.1 under
various license levels. Hilariously, due to some quirk that I haven&#39;t been able to figure out,
all machines have been reporting the following traceback when running &lt;code&gt;&amp;gt;&amp;gt;&amp;gt; import numpy&lt;/code&gt; from
ArcGIS Desktop&#39;s internal Python console.&lt;/p&gt;
&lt;!-- more --&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; import numpy
Runtime error 
Traceback (most recent call last):
  File &amp;quot;&amp;lt;string&amp;gt;&amp;quot;, line 1, in &amp;lt;module&amp;gt;
  File &amp;quot;c:&#92;program files (x86)&#92;arcgis&#92;desktop10.1&#92;arcpy&#92;arcpy&#92;__init__.py&amp;quot;, line 24, in &amp;lt;module&amp;gt;
    from arcpy.toolbox import *
  File &amp;quot;c:&#92;program files (x86)&#92;arcgis&#92;desktop10.1&#92;arcpy&#92;arcpy&#92;toolbox.py&amp;quot;, line 342, in &amp;lt;module&amp;gt;
    from management import Graph, GraphTemplate
  File &amp;quot;c:&#92;program files (x86)&#92;arcgis&#92;desktop10.1&#92;arcpy&#92;arcpy&#92;management.py&amp;quot;, line 22, in &amp;lt;module&amp;gt;
    import _management
  File &amp;quot;c:&#92;program files (x86)&#92;arcgis&#92;desktop10.1&#92;arcpy&#92;arcpy&#92;_management.py&amp;quot;, line 14, in &amp;lt;module&amp;gt;
    import _graph
  File &amp;quot;c:&#92;program files (x86)&#92;arcgis&#92;desktop10.1&#92;arcpy&#92;arcpy&#92;_graph.py&amp;quot;, line 27, in &amp;lt;module&amp;gt;
    import numpy
ImportError: No module named numpy
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;One solution to this is to explicitly append the &lt;code&gt;PYTHONPATH&lt;/code&gt; environment variable to reference the ArcGIS10.1 Python install&#39;s &lt;code&gt;site-packages&lt;/code&gt; directory.&lt;/p&gt;
&lt;h1 id=&quot;creation-of-pythonpath-environment-variable&quot; tabindex=&quot;-1&quot;&gt;Creation of PYTHONPATH Environment Variable &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-07-10-fixing-arcgis-10-dot-1-python-console-numpy-import-error/&quot;&gt;#&lt;/a&gt;&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;From the start menu, right click the &lt;code&gt;computer&lt;/code&gt; button and select &lt;code&gt;properties&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Click &lt;code&gt;Advanced System Settings&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Click the &lt;code&gt;Advanced&lt;/code&gt; tab, and select the &lt;code&gt;Environment Variables&lt;/code&gt; button.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Click &lt;code&gt;New&lt;/code&gt; to create a new environment variable.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Name the environment variable &lt;code&gt;PYTHONPATH&lt;/code&gt; and set it&#39;s value to point to the &lt;code&gt;site-packages&lt;/code&gt; directory for ArcGIS. For my instance, this is &lt;code&gt;C:&#92;Python27&#92;ArcGIS10.1&#92;Lib&#92;site-packages&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Restart the machine. You should now be able to successfully import numpy, arcpy, and any other Python modules installed as part of the ArcGIS 10.x version of Python.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
	</entry>
	
	<entry>
		<title>Auto-Push to GitHub via Machine User</title>
		<link href="https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/"/>
		<updated>2013-06-16T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/</id>
		<content type="html">&lt;p&gt;This post will review a workflow for automatically pushing data from a client machine to github.
This can be useful if you want to automatically make publicly available data that are regularly processed on
a local machine. &lt;!-- more --&gt; For my particular use case, I&#39;m downloading data from the &lt;a href=&quot;http://waterservices.usgs.gov/rest/IV-Test-Tool.html&quot;&gt;USGS Instantaneus Values
Web Service&lt;/a&gt; , and would
like to process those data locally for use in a d3 visualization. My d3 viz will eventually be
hosted on github as well, so having a dynamically updated dataset stored on github made sense.
I&#39;m sure that it&#39;s possible to emulate this ETL workflow in pure JavaScript, but I wanted to see
how to set this up, in the event that I found myself in a situation in which heavy pre-processing
of data was required.&lt;/p&gt;
&lt;p&gt;The general steps are as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;On the local machine, create a machine user and group.&lt;/li&gt;
&lt;li&gt;Create a corresponding github account for the machine user.&lt;/li&gt;
&lt;li&gt;Generate an SSH key machine user &amp;amp; associate the public key of the machine user to its github account.&lt;/li&gt;
&lt;li&gt;Assign the github account to the repository of interest.&lt;/li&gt;
&lt;li&gt;Clone the repository of interest, making it group writable.&lt;/li&gt;
&lt;li&gt;On the local machine, create a cron job under the machine user to execute the processing script.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;create-machine-user-and-group&quot; tabindex=&quot;-1&quot;&gt;Create Machine User and Group &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;On my local machine, I start by creating a user and group for the purpose of pushing data to github.
I&#39;m doing this to isolate the amount of exposure that this user has to my wider system.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Create the user, rdi-git&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; adduser rdi-git
&lt;span class=&quot;token comment&quot;&gt;# You&#39;ll be prompted to enter a password as well.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Create the group, git&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; addgroup &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Add our new user (rdi-git) to the new group (git)&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;usermod&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-G&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; rdi-git&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;create-a-github-account-for-machine-user&quot; tabindex=&quot;-1&quot;&gt;Create a Github Account for Machine User &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After having created the machine users on my local box, the next step is to create an analogous
user on &lt;a href=&quot;https://github.com&quot;&gt;github&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;generate-ssh-key-and-assign-to-github-user&quot; tabindex=&quot;-1&quot;&gt;Generate SSH Key &amp;amp; Assign to Github User &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;From the local machine, make sure that you&#39;re logged in as the newly created machine user.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;su&lt;/span&gt; rdi-git&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;At this point, I defer to the great instructions on the Github help docs for &lt;a href=&quot;https://help.github.com/articles/generating-ssh-keys&quot;&gt;generating an ssh key&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;assign-github-account-as-collaborator-to-repo-of-interest&quot; tabindex=&quot;-1&quot;&gt;Assign Github Account As Collaborator to Repo of Interest &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Next, I add our github user, rdi-git, as a collaborator on my repository of interest. Here is a link on
the &lt;a href=&quot;https://help.github.com/articles/how-do-i-add-a-collaborator&quot;&gt;Github help docs&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;clone-the-repository-of-interest-add-assign-permissions&quot; tabindex=&quot;-1&quot;&gt;Clone the Repository of Interest, add Assign Permissions &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&#39;m creating a &lt;code&gt;/projects/&lt;/code&gt; folder, in which I&#39;ll clone my repo. I&#39;d like to ensure that this folder, and
subsequently all repos contained within it, are associated with git group. This &lt;a href=&quot;http://unix.stackexchange.com/questions/12842/make-all-new-files-in-a-directory-accessible-to-a-group&quot;&gt;stackoverflow&lt;/a&gt; outlines the required commands.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Make the directory&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; /
$ &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; projects
$ &lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; /projects
&lt;span class=&quot;token comment&quot;&gt;# Change perms to group writable. See Above SO post.&lt;/span&gt;
$ &lt;span class=&quot;token builtin class-name&quot;&gt;umask&lt;/span&gt; 002            &lt;span class=&quot;token comment&quot;&gt;# allow group write; everyone must do this&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;chgrp&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;          &lt;span class=&quot;token comment&quot;&gt;# set directory group to gitG&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; g+s &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;          &lt;span class=&quot;token comment&quot;&gt;# files created in directory will be in group git&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Clone our repo of interest, using ssh&lt;/span&gt;
$ git@github.com:mattmakesmaps/robo-d3.git &lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;create-the-cron-job&quot; tabindex=&quot;-1&quot;&gt;Create the Cron Job &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-06-16-auto-push-to-github-via-machine-user/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The repo I&#39;ve just cloned contains the &lt;a href=&quot;https://github.com/mattmakesmaps/robo-d3/blob/master/scripts/waterservices_parser.py&quot;&gt;processing script&lt;/a&gt; I&#39;ll be running.
Our processed data will also be stored and pushed back to this repository.&lt;/p&gt;
&lt;p&gt;I&#39;d like to have my processing script run once every hour, on the hour. We setup the cron job by first entering
crontab.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Login as machine user, cron job will be run under this id.&lt;/span&gt;
$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;su&lt;/span&gt; rdi-git
$ &lt;span class=&quot;token function&quot;&gt;crontab&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-e&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here is an excerpt of the machine user&#39;s cron jobs, with the new job added at the bottom.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# For more information see the manual pages of crontab(5) and cron(8)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# m h  dom mon dow   command&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; * * * * python /projects/robo-d3/scripts/waterservices_parser.py &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; ~/robo-d3.log &lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;2&lt;/span&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;&amp;amp;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We essential say, on the minute zero, of every hour, for every day, month, and weekday, run the command &#39;python /path/to/script&#39;. The tail indicates that we&#39;re outputting both STDOUT and the ERROR log to &lt;code&gt;/home/rdi-git/robo-d3.log&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;And there we go. If we check out the &lt;a href=&quot;https://github.com/mattmakesmaps/robo-d3/commits/master&quot;&gt;commit logs&lt;/a&gt; we can
see that our github user, rdi-git, has been pushing every hour on the hour. Woo-hoo!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Hack GeoDjango Admin with Mapquest Tiles</title>
		<link href="https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/"/>
		<updated>2013-05-01T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/</id>
		<content type="html">&lt;p&gt;The &lt;a href=&quot;http://geodjango.org/&quot;&gt;GeoDjango model&lt;/a&gt; admin provides a great &lt;a href=&quot;http://openlayers.org/&quot;&gt;OpenLayers&lt;/a&gt; interface, allowing a user to create geographic features (points, lines, polygons) directly via a web map. Out-of-the-box,
GeoDjango ships with a base GeoAdmin class, using the default OL world borders layer,
as well as a subclass for OSM streets data. The OSM layer is great, and provides a good base
for most use cases. That being said, for &lt;a href=&quot;https://github.com/mattmakesmaps/PntTrax&quot;&gt;PntTrax&lt;/a&gt;, I needed aerial tiles. &lt;!-- more --&gt;My application deals
primarily with the storage of field collected (GPS, field notes, aerial markup, etc.) data.
Our data occur primarily in non-urban areas, where natural features provide a much
better context for orientation then would be expected with any streets layer, OSM or otherwise.
Mapquest provides a good set of aerial tiles, that can be easily integrated into OpenLayers.&lt;/p&gt;
&lt;p&gt;It&#39;s easier to place a point on this:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Then this:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Original Image Unavailable.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Hacking the admin to display the &lt;a href=&quot;http://developer.mapquest.com/web/products/open/map&quot;&gt;Mapquest aerial tiles&lt;/a&gt; is a pretty straightforward process.
From the gis contrib package, we&#39;ll modify &lt;a href=&quot;https://github.com/django/django/blob/master/django/contrib/gis/admin/options.py&quot;&gt;options.py&lt;/a&gt; and its &lt;a href=&quot;https://github.com/django/django/blob/master/django/contrib/gis/admin/__init__.py&quot;&gt;__init__.py&lt;/a&gt;, subclassing the OSMGeoAdmin. Within the &lt;a href=&quot;https://github.com/django/django/tree/master/django/contrib/gis/templates/gis/admin&quot;&gt;templates
folder&lt;/a&gt;,
we&#39;ll create two new files, a html template file, that actually points to a javascript file
containing a reference to the Mapquest Open Aerial tiles service.&lt;/p&gt;
&lt;h2 id=&quot;creating-mapquestgeoadminsubclass&quot; tabindex=&quot;-1&quot;&gt;Creating mapquestGeoAdminSubclass &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&quot;https://github.com/django/django/blob/master/django/contrib/gis/admin/options.py#L132-L139&quot;&gt;OSMGeoAdmin class&lt;/a&gt; is a subclass of the base GeoModelAdmin. The GeoModelAdmin contains a set of
configuration parameters for the map, covering basic setup. The OSMGeoAdmin class utilizes
many of those configuration parameters, but configures the map for a spherical mercator projection.
Since our Mapquest Aerial Tiles also require a spherical mercator projection, our class will
be a subclass of the OSMGeoAdmin.&lt;/p&gt;
&lt;p&gt;We add the following code below the OSMGeoAdmin class definition.&lt;/p&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token comment&quot;&gt;# Subclass OSMGeoAdmin, pointing to the To-Be-Created&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Mapquest template file.`&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;mapquestGeoAdmin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;OSMGeoAdmin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        map_template &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;gis/admin/mapquest.html&#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;modify-the-gis-admin-package-s-init-py&quot; tabindex=&quot;-1&quot;&gt;Modify the GIS Admin Package&#39;s __init__.py &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;__init__.py&lt;/code&gt; file imports the &lt;code&gt;OSMGeoAdmin&lt;/code&gt; class, let&#39;s modify it to include our
new subclass&lt;/p&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token comment&quot;&gt;# From this&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contrib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;gis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;admin&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;options &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; OSMGeoAdmin
    &lt;span class=&quot;token comment&quot;&gt;# To this&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contrib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;gis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;admin&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;options &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; OSMGeoAdmin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mapquestGeoAdmin&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;create-mapquest-js&quot; tabindex=&quot;-1&quot;&gt;Create mapquest.js &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Again, using the OpenStreetMap implementation as a reference, we can see that &lt;code&gt;osm.js&lt;/code&gt; extends the basic &lt;code&gt;openlayers.js&lt;/code&gt; file, but replaces the contents of the &lt;code&gt;base layer&lt;/code&gt;
block with an a reference to the OpenStreetMap layer.&lt;/p&gt;
&lt;p&gt;We&#39;ll create a similar file in this package called &lt;code&gt;mapquest.js&lt;/code&gt;. The contents are as
follows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{# Source: http://openlayers.org/dev/examples/mapquest.html #}
{% extends &amp;quot;gis/admin/openlayers.js&amp;quot; %}
{% block base_layer %}
        new OpenLayers.Layer.XYZ(
            &amp;quot;Imagery&amp;quot;,
            [
                &amp;quot;http://otile1.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png&amp;quot;,
                &amp;quot;http://otile2.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png&amp;quot;,
                &amp;quot;http://otile3.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png&amp;quot;,
                &amp;quot;http://otile4.mqcdn.com/tiles/1.0.0/sat/${z}/${x}/${y}.png&amp;quot;
            ],
            {
                attribution: &amp;quot;Tiles Courtesy of &amp;lt;a href=&#39;http://open.mapquest.co.uk/&#39; target=&#39;_blank&#39;&amp;gt;MapQuest&amp;lt;/a&amp;gt;. Portions Courtesy NASA/JPL-Caltech and U.S. Depart. of Agriculture, Farm Service Agency. &amp;lt;img src=&#39;http://developer.mapquest.com/content/osm/mq_logo.png&#39; border=&#39;0&#39;&amp;gt;&amp;quot;,
                transitionEffect: &amp;quot;resize&amp;quot;
            }
        )
{% endblock %}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;create-mapquest-html&quot; tabindex=&quot;-1&quot;&gt;Create mapquest.html &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the same folder, we&#39;ll create an html template file, pointing to our javascript file.
We&#39;ll call the file &lt;code&gt;mapquest.html&lt;/code&gt;. Here are the contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% extends &amp;quot;gis/admin/openlayers.html&amp;quot; %}
{% block openlayers %}{% include &amp;quot;gis/admin/mapquest.js&amp;quot; %}{% endblock %}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;in-admin-py-reference-mapquestgeoadmin&quot; tabindex=&quot;-1&quot;&gt;In admin.py, Reference mapquestGeoAdmin &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2013-05-01-django-add-mapquest-tiles/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The last step is to replace references to &lt;code&gt;GeoModelAdmin&lt;/code&gt; or &lt;code&gt;OSMGeoAdmin&lt;/code&gt; to
&lt;code&gt;mapquestGeoAdmin&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PntTraxGeoAdmin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;admin&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mapquestGeoAdmin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;Base Class for Geometry Table Admin&quot;&quot;&quot;&lt;/span&gt;
    list_display &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;name&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;collectDate&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;group&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;featurePurpose&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;collectionMethod&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    list_editable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;featurePurpose&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;group&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;collectionMethod&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    list_filter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;featurePurpose&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;group__name&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And there you go. Your Django GeoAdmin interface is now rocking aerial tiles courtesy
of Mapquest.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>GeoDjango: Standing Up A GeoJSON Web-Service</title>
		<link href="https://mattmakesmaps.com/blog/2011-12-12-geodjango-standing-up-a-geojson-web-service/"/>
		<updated>2011-12-12T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2011-12-12-geodjango-standing-up-a-geojson-web-service/</id>
		<content type="html">&lt;p&gt;The models are complete. The database is loaded with some test tabular and spatial data. We&#39;re pushing out HTML representations of attribute data using GeoDjango&#39;s standard templating functions. Now, the focus moves to visualizing these features&#39; geometries in a spatial context. Just as with a Django QuerySet, GeoDjango provides a GeoQuerySet. &lt;!-- more --&gt; When paired with a spatially-enabled database (e.g. PostGIS, SpatialLite, etc.), the GeoQuerySet provides functionality for querying data using a series of spatial filters, in addition to tabular filters. As a point of reference, the GeoDjango docs have great tables depicting a blow-by-blow comparison of different spatial databases, displaying each available &lt;a href=&quot;https://docs.djangoproject.com/en/dev/ref/contrib/gis/db-api/#spatial-lookup-compatibility&quot;&gt;Spatial Lookup&lt;/a&gt; and &lt;a href=&quot;https://docs.djangoproject.com/en/dev/ref/contrib/gis/db-api/#geoqueryset-methods&quot;&gt;GeoQuerySet method&lt;/a&gt;. Take note, PostGIS is the clear winner in terms of functionality ;)&lt;/p&gt;
&lt;h2 id=&quot;why-geojson&quot; tabindex=&quot;-1&quot;&gt;Why GeoJSON? &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2011-12-12-geodjango-standing-up-a-geojson-web-service/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;From the perspective of exporting data, GeoDjango supports a number of formats. The GeoQuerySet methods can represent your model&#39;s geometry column in a number of different &lt;a href=&quot;https://docs.djangoproject.com/en/dev/ref/contrib/gis/geoquerysets/#geometry-output&quot;&gt;formats&lt;/a&gt;: GeoHash, GeoJSON, GML, KML, and SVG. Of all these serialization formats, I&#39;ve found KML to be the most frequently used amongst GeoDjango users. Illustrative of this, three of the four functions in &lt;a href=&quot;https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/shortcuts.py&quot;&gt;django.contrib.gis.shortcuts&lt;/a&gt; have to do with KML/KMZ. That&#39;s awesome, but where is the love for GeoJSON?&lt;/p&gt;
&lt;p&gt;KML can be easily consumed by OpenLayers, the king of open source web mapping viewers. But some of the new kids, e.g. leaflet, polymaps, look to favor GeoJSON over KML as an input for dynamically rendered data, not directly consuming KML out-of-the-box. That being said, if you want KML, this &lt;a href=&quot;https://github.com/shramov/Leaflet/tree/master/src/layer&quot;&gt;fork of leaflet&lt;/a&gt; looks like it will work for you. In my particular project, I&#39;m interested in using leaflet, so GeoJSON was the way to go.&lt;/p&gt;
&lt;p&gt;Later on, I&#39;d like to do some speed comparisons, rendering the same featureset using OpenLayers, represented as both KML and GeoJSON, but that&#39;s for the future. I&#39;m wondering if OpenLayers will handle the JSON object faster then KML&#39;s XML? JSON is just JavaScript after all.&lt;/p&gt;
&lt;h2 id=&quot;the-problem&quot; tabindex=&quot;-1&quot;&gt;The Problem &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2011-12-12-geodjango-standing-up-a-geojson-web-service/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The GeoDjango GeoQuerySet API has built in methods to handle the serialization and de-serialization of a result set&#39;s geometries into different formats. The problem is that these methods only wrap the geometries of a result set. For display in a web mapping application, like leaflet, I want to have access to both the geometry in the format of my choosing, as well as the supplementary attributes (name, type, etc.) which provide context for that geometry.&lt;/p&gt;
&lt;p&gt;For example, asking for the GeoJSON representation of a given feature through Django&#39;s shell, like this:&lt;/p&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Import Models from the Company Application&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; company&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Models &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Create a GeoQuerySet from the primary key, return GeoJSON&lt;/span&gt;
qs &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Boundary&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pk&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geojson&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Print GeoJSON representation of geom&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; qs&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;geojson&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Will produce a GeoJSON object like this:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;MultiPolygon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;coordinates&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.574295&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token number&quot;&gt;47.856636&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.573924&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token number&quot;&gt;47.85718&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.573719&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token number&quot;&gt;47.85757&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Truncated Verticies&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As shown in the example above, the geometries are returned, but not the tabular attributes associated with that feature. Looking at the &lt;a href=&quot;http://geojson.org/geojson-spec.html&quot;&gt;GeoJSON spec&lt;/a&gt;, there are multiple &#39;type&#39; values which an object can be constrained by. Using GeoDjango&#39;s geoJSON() method will produce a type matching the geometry listed in the associated GeoDjango model (point, line, polygon, etc). The distinction here is that I&#39;d like to return a GeoJSON object of type &#39;Feature&#39; or &#39;FeatureCollection&#39;. These types require an additional &#39;properties&#39; parameter, which can store tabular attributes. From the spec:&lt;/p&gt;
&lt;blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;A feature object must have a member with the name &amp;quot;properties&amp;quot;. The value of the properties member is an object (any JSON object or a JSON null value).&lt;/p&gt;
&lt;p&gt;So, the trick now is to dynamically create a GeoJSON object which contains both populated Geom and Properties attributes.&lt;/p&gt;
&lt;h2 id=&quot;the-fix-vectorformats&quot; tabindex=&quot;-1&quot;&gt;The fix (vectorformats) &lt;a class=&quot;header-anchor&quot; href=&quot;https://mattmakesmaps.com/blog/2011-12-12-geodjango-standing-up-a-geojson-web-service/&quot;&gt;#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In order to create a fully populated GeoJSON object, we need to bring in some extra assistance. Some quick searching brought me to this stack exchange &lt;a href=&quot;http://stackoverflow.com/questions/3034482/rendering-spatial-data-of-geoqueryset-in-a-custom-view-on-geodjango&quot;&gt;response&lt;/a&gt;, from &lt;a href=&quot;http://crschmidt.net/blog/&quot;&gt;Chris Schmidt&lt;/a&gt;. Chris&#39; vectorformats package handles the serialization and de-serializtion of a variety of formats, including Django Querysets and GeoJSON. From the project &lt;a href=&quot;http://packages.python.org/vectorformats/&quot;&gt;homepage&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;The vectorformats library is designed to make it easy to serialize content from any source to any source within Python. Think of it as a poor mans OGR  a pure Python implementation of transforming features to and from various formats (largely XML based).&lt;/p&gt;
&lt;p&gt;Installing vectorformats is as easy as:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$sudo&lt;/span&gt; easy_install vectorformats&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From there, as outlined in the above referenced post, it&#39;s only a matter of adding a few lines into your GeoDjango app&#39;s &lt;a href=&quot;https://github.com/mattmakesmaps/geodjango/blob/master/sampling/views.py&quot;&gt;view function&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Using vectorfeatures module return a GeoJSON FeatureCollection&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# for a given boundary ID.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;boundary_detail&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; boundary_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    boundary_detail &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Boundary&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;objects&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pk&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;boundary_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    djf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Django&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Django&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;geodjango&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;geom&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; properties&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;name&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    geoj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; GeoJSON&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GeoJSON&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    s &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; geoj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;djf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;boundary_detail&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; HttpResponse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The resulting GeoJSON object, represented as a &#39;type&#39; of &#39;FeatureCollection&#39;:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;crs&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;FeatureCollection&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;features&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;geometry&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;MultiPolygon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;coordinates&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.574295&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;47.856636&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.573924&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;47.85718&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.573719&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;47.85757&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Truncated Verticies&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Feature&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Port Gamble&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And there you have it, GeoJSON containing both the geometry and attributes. This output can now be mapped to URL, creating an endpoint such as &#39;http://my-site.com/geojson/boundary/{boundary_id}/&#39;. Pass this to your web mapping client, and you&#39;re ready to rock.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Moving to GeoDjango</title>
		<link href="https://mattmakesmaps.com/blog/2011-11-28-moving-to-geodjango/"/>
		<updated>2011-11-28T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2011-11-28-moving-to-geodjango/</id>
		<content type="html">&lt;p&gt;I&#39;ve been creating a simple GeoDjango application for managing environmental sampling metadata, and it&#39;s been a lot of fun so far. I&#39;ve had experience working with many different forms of metadata tracking, from spreadsheets, to wikis, to online project management tools. All of them have their ups and downs, and it seems like there is always a dealbreaker with each organizational method.&lt;/p&gt;
&lt;p&gt;Spreadsheets are easy to edit, but lack any form of relational structure (two sets of data for the same report? i guess i&#39;ll just put two entries into the same cell).&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_487&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;464&amp;quot; caption=&amp;quot;sometimes spreadsheets just don&#39;t work...&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Wikis are cool, allow easy access to information, but are (in certain cases) a pain for folks to edit. Take the experience of table creation. Dokuwiki, a generic wiki software, requires a series of carefully placed carrots and pipes to delineate headers and columns. A common pain comes when adding a new value to a new row, in which that value exceeds the length of any previous cell. This requires the author to expand the column header, and all previously entered rows, re-aligning the pipes and carrots. Granted as a slightly OCD GIS Analyst, the sight of a well crafted text table fills me with no less wonder then when I saw AlbertBierstadt&#39;s &lt;a href=&quot;http://www.seattleartmuseum.org/exhibit/exhibitDetail.asp?eventID=21084&quot;&gt;&amp;quot;Puget Sound on the Pacific Coast&amp;quot;&lt;/a&gt;, but it&#39;s just darn tedious at times. Additionally, as the log of sampling events grows larger, it gets harder to manage. Dokuwiki, AFAIK provides no ways to automatically resort entire sections of pages or records in tables based on alphabetical order, which would make searching for information on a particular page much faster as content becomes larger and larger.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;^ Column One                ^ Column Two                 ^
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; Zee &lt;span class=&quot;token string&quot;&gt;&#39;z&#39;&lt;/span&gt; string            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; This is a longer string    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; 2nd longer string of text &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; 2nd short string           &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; SuperShort                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; A string starting with &lt;span class=&quot;token string&quot;&gt;&#39;A&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Online project management tools are interesting as well. They allow rapid collaboration between project members, and provide template functionality, allowing for status reports on recurring workflows to be easily generated (e.g., create a template for a report, spawn off an instance of a template for each new project). The downside to these services are that: they cost money, they also may not provide a normalized way to store data, and (of most interest to myself) they probably don&#39;t allow for the storage/visualization of spatial data.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_488&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;10 megs free for one user? cool!&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot-1.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot-1-300x162.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;In comes GeoDjango. Over the next few posts, I think I&#39;ll record my experiences developing an application that allows the storage of metadata, within the context of environmental sampling efforts. The goal is to provide a web application which stores both tabular and spatial data in a normalized fashion, and easily visualize both in an informative way.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_489&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Hey look Ma&#39;, it&#39;s GeoJSON!&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot-2.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/11/Screenshot-2-300x147.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Hand-Rolled Vector Tiles - TileStache</title>
		<link href="https://mattmakesmaps.com/blog/2011-02-25-hand-rolled-vector-tiles-tilestache/"/>
		<updated>2011-02-25T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2011-02-25-hand-rolled-vector-tiles-tilestache/</id>
		<content type="html">&lt;p&gt;A few weeks ago I found myself surfing the intertubes for instructions on how to serve up some vector tile goodness. That search came up pretty much empty, except for one glimmering &lt;a href=&quot;http://gis.stackexchange.com/questions/3712/create-vector-geojson-tiles-for-polymaps&quot;&gt;thread&lt;/a&gt; of hope. The answer, &lt;a href=&quot;http://tilestache.org/&quot;&gt;TileStache&lt;/a&gt; { &amp;lt;-- Imagine that&#39;s a mustache on it&#39;s side.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TileStache is a Python-based server application that can serve up map tiles based on rendered geographic data.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- more --&gt;
&lt;p&gt;By design, TileStache can be used to serve up stylish TMS tiles using &lt;a href=&quot;http://mapnik.org/&quot;&gt;mapnik&lt;/a&gt; map files, and can also be used to locally cache remote-services via &lt;a href=&quot;http://tilestache.org/doc/#providers&quot;&gt;proxy&lt;/a&gt;. What I&#39;m most interested in though, is it&#39;s ability to deploy vector tiles. So what are vector tiles? Think TMS tiles... but replace representations of the geometries through images, with &lt;a href=&quot;http://geojson.org/&quot;&gt;GeoJSON&lt;/a&gt;. Pretty wild right? Specifically, the TileStache &lt;a href=&quot;http://tilestache.org/doc/TileStache.Goodies.Providers.PostGeoJSON.html&quot;&gt;PostGeoJSON Provider&lt;/a&gt; can be used to connect TileStache to a PostGIS data source, and return a tile comprised entirely of GeoJSON data.&lt;/p&gt;
&lt;p&gt;For example, data from a PostGIS data source can be rendered as an image tile (.../10/16/357.png), like this:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/tile.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/tile.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But can also be represtented as a vector tile (.../10/16/357.json), like this:&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Subset of a single 256x256 pixel vector tile.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FeatureCollection&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string-property property&quot;&gt;&quot;features&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;geometry&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;MultiPolygon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;coordinates&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.973093&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;47.969842&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.973093&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token number&quot;&gt;47.969842&lt;/span&gt;
              &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Feature&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;property_s&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;USFS&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string-property property&quot;&gt;&quot;juris_name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Olympic National Forest&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token string-property property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1280&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So what are the advantages of using vector tiles? You can already use &lt;a href=&quot;http://dev.openlayers.org/docs/files/OpenLayers/Format/GeoJSON-js.html&quot;&gt;OpenLayers&#39; GeoJSON&lt;/a&gt; format reader to populate a vector layer in OL. It&#39;s an issue of size. Highly complex geometries can be large in size, and requesting all that data at once can be time consuming. Vector tiles approach this problem using the same answer as TMS... only request those sections of data which you need at that time. By only requesting those tiles within the user&#39;s current extent + a small buffer, the need to download large geometries at once can be negated. Furthermore, just as TMS&#39;s can be pre-cached to disk (seeded), so can vector tiles.&lt;/p&gt;
&lt;p&gt;One example of this is serving up a combined NFS boundary dataset compiled by my good pal, Greg (&lt;a href=&quot;http://www.chopshopgeo.com/blog/&quot;&gt;http://www.chopshopgeo.com/blog/&lt;/a&gt;). These boundaries are &lt;strong&gt;dense&lt;/strong&gt; and displaying them at their full extent &amp;amp; raw level of detail is expensive. But by breaking the vector representations of these geometries up into a standard tile scheme, only those tiles which we need are requested, and only when we need them. As a side note, in addition to tiling, I also simplified the boundaries, to promote faster load time at small-scales. The least granular vector representations display at the smallest zoom-scales, while the highest (raw, unsimplified) level of granularity displays only at the largest zoom-scales.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_398&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;665&amp;quot; caption=&amp;quot;NFS Boundaries Provided By ChopShopGeo&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/parks.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/parks.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Additionally, using vector representations of geometry rather then cached images allows styling of those geometries on the fly. &lt;a href=&quot;http://polymaps.org/&quot;&gt;Polymaps&lt;/a&gt;, the only display client I&#39;ve found so far that can consume vector tiles out-of-the-box, renders these tiles as SVG elements. Because of this, unique styling can be applied via CSS; controlling the color, stroke, fill, etc. of each geometry in response to both attributes associated with the geometry (see image below) or user input... ala the &lt;a href=&quot;http://polymaps.org/ex/statehood.html&quot;&gt;Polymaps example page&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_393&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;691&amp;quot; caption=&amp;quot;USGS real-time gauge stations. Darker dots represent stronger streamflow, lighter dots represent slower flow. You&#39;ll have to ignore the fact that I&#39;m symbolizing streamflow without the streams.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/usgs.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2011/02/usgs.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;The above example converts data from the &lt;a href=&quot;http://waterservices.usgs.gov/rest/WOF-IV-Service.html&quot;&gt;USGS Instantaneous Values Web Service&lt;/a&gt; (part of the &lt;a href=&quot;http://waterdata.usgs.gov/nwis/&quot;&gt;USGS Water Date for the Nation program&lt;/a&gt;) as a JSON response to GeoJSON. These data points are then symbolized dynamically using Polymaps. More on that later.&lt;/p&gt;
&lt;pre class=&quot;language-javascript&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;FeatureCollection&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;features&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;geometry&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;MultiPolygon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;coordinates&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.973093&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47.969842&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;122.973093&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47.969842&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token literal-property property&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//jsbeautifier.org/&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Feature&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;properties&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;property_s&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;USFS&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;juris_name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Olympic National Forest&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token string-property property&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1280&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
</content>
	</entry>
	
	<entry>
		<title>cURL&#39;ing to FeatureServer from PostGIS: Easier then I Thought</title>
		<link href="https://mattmakesmaps.com/blog/2010-07-09-curling-to-featureserver-from-postgis-easier-then-i-thought/"/>
		<updated>2010-07-09T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2010-07-09-curling-to-featureserver-from-postgis-easier-then-i-thought/</id>
		<content type="html">&lt;p&gt;So I&#39;ve finished cutting a draft tileset using mapnik, &lt;a href=&quot;http://mkgeomatics.com/apps/bus/bus.html&quot;&gt;depicting bus routes in Bellingham, WA&lt;/a&gt;. Now that the cartography is well in progress, I&#39;d like to add some interactivity to the map. My first attempt at this will be to utilize MetaCarta (Chris Schmidt)&#39;s &lt;a href=&quot;http://featureserver.org/&quot;&gt;FeatureServer&lt;/a&gt;. &lt;!-- more --&gt; FeatureServer allows one to use standard HTTP verbs to GET representations of data, POST new data, or DELETE existing data. While querying data you can also pass additional URL parameters like a bounding box or attribute to select out a smaller subset of returned representations. I&#39;ll be POST&#39;ing a bus stop dataset to FeatureServer as GeoJSON. Once the data are stored in FeatureServer, I&#39;ll be able to add popups based on a user&#39;s click of a bus stop. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Getting data stored on my local PostGIS install to my remote FeatureServer instance turned out to be a three step process.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Step One:&lt;/strong&gt; Convert local PostGIS bus stops layer to GeoJSON via OGR&lt;/p&gt;
&lt;p&gt;I had originally planned on writing a pg/plsql function to try and output a bash script. The script would cURL each feature individually to my FeatureServer instance. This proved to be way more work then I had expected. What was the solution? &lt;a href=&quot;http://www.gdal.org/ogr/&quot;&gt;OGR&lt;/a&gt;, of course. OGR has read/write drivers for both &lt;a href=&quot;http://www.gdal.org/ogr/drv_geojson.html&quot;&gt;GeoJSON&lt;/a&gt; and &lt;a href=&quot;http://www.gdal.org/ogr/drv_pg.html&quot;&gt;PostGIS&lt;/a&gt;. This allows one to convert an entire dataset to GeoJSON with a single command (see below).&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;bash&amp;quot;]
ogr2ogr -f &amp;quot;GeoJSON&amp;quot; ogrstops.json PG:&amp;quot;host=localhost dbname=routing user=postgres password=*** port=5432&amp;quot; &amp;quot;wtastops(the_geom)&amp;quot;
[/sourcecode]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Step 2:&lt;/strong&gt; Wrap &amp;quot;coordinate&amp;quot; elements in double brackets&lt;/p&gt;
&lt;p&gt;When initially trying to cURL the GeoJSON output to FeatureServer, I was receiving an error stating that a bounding box could not be determined for the first geometry in my dataset. After some trial-and-error, I soon realized that the OGR output FeatureCollection was wrapping each point feature&#39;s geometry in a single set of brackets. This type of behavior follows the GeoJSON &lt;a href=&quot;http://geojson.org/geojson-spec.html#id9&quot;&gt;specification for a FeatureCollection&lt;/a&gt;, as far as I can tell. However, in order for FeatureServer to consume this dataset, each point feature is required to be wrapped in a second set of brackets. I used gedit to run the find/replace. Below is an example of a GeoJSON feature which FeatureServer can consume. This individual feature is part of a larger FeatureCollection.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;js&amp;quot;]&lt;/p&gt;
&lt;p&gt;{ &amp;quot;type&amp;quot;: &amp;quot;Feature&amp;quot;,
&amp;quot;properties&amp;quot;: {
&amp;quot;POINT_ID&amp;quot;: &amp;quot;1000&amp;quot;,
&amp;quot;POINT_NAME&amp;quot;: &amp;quot;Fielding at 32nd&amp;quot;,
&amp;quot;SHELTER&amp;quot;: &amp;quot;Yes&amp;quot;, &amp;quot;BENCH&amp;quot;: &amp;quot;No&amp;quot; },
&amp;quot;geometry&amp;quot;: {
&amp;quot;type&amp;quot;: &amp;quot;Point&amp;quot;,
&amp;quot;coordinates&amp;quot;: [[-122.474490,48.730021]]}
}
[/sourcecode]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Step 3:&lt;/strong&gt; cURL GeoJSON to FeatureServer&lt;/p&gt;
&lt;p&gt;The last step is to actually POST the data to FeatureServer. For that, I used cURL.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;bash&amp;quot;]&lt;/p&gt;
&lt;p&gt;curl -d @ogrstops.json http://mkgeomatics.com/cgi-bin/featureserver/featureserver.cgi/scribble/create.json&lt;/p&gt;
&lt;p&gt;[/sourcecode]&lt;/p&gt;
&lt;p&gt;Now that the features have been uploaded, we can view them via FeatureServer as &lt;a href=&quot;http://mkgeomatics.com/cgi-bin/featureserver/featureserver.cgi/scribble/all.georss&quot;&gt;GeoRSS&lt;/a&gt;, &lt;a href=&quot;http://mkgeomatics.com/cgi-bin/featureserver/featureserver.cgi/scribble/all.kml&quot;&gt;KML&lt;/a&gt;, &lt;a href=&quot;http://mkgeomatics.com/cgi-bin/featureserver/featureserver.cgi/scribble/all.json&quot;&gt;JSON&lt;/a&gt;, &lt;a href=&quot;http://mkgeomatics.com/cgi-bin/featureserver/featureserver.cgi/scribble/all.gml&quot;&gt;GML&lt;/a&gt;. Neat!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>PL/pgSQL function to Iterate pgRouting</title>
		<link href="https://mattmakesmaps.com/blog/2010-06-28-plpgsql-function-to-iterate-pgrouting/"/>
		<updated>2010-06-28T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2010-06-28-plpgsql-function-to-iterate-pgrouting/</id>
		<content type="html">&lt;p&gt;I&#39;ve been working on a side project using &lt;a href=&quot;http://www.mkgeomatics.com/wordpress/?s=pgRouting&amp;amp;searchsubmit=Find&quot;&gt;pgRouting&lt;/a&gt; to determine the least-cost path across a street network from a given building to the nearest bus stop within &lt;a href=&quot;http://en.wikipedia.org/wiki/Bellingham,_Washington&quot;&gt;Bellingham, WA&lt;/a&gt;. It&#39;s one thing to execute pgRouting&#39;s built-in functions for a single vertex (building) to another vertex (bus stop)... but another to have the function iterate through all buildings and their closest bus stop. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;So that began my first experience with using PL/pgSQL. The benefit for using the procedural language for PostgreSQL lies in its ability to loop through collections of records easily. I&#39;ve posted my function below. It&#39;s not pretty, but it&#39;s filled with enough notices to let me know where an error occurs, which helped me understand how things were acting each step of the way. Here is the basic idea:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Loop through a table in which each row has a source and destination vertex&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Execute the pgRouting function using these two vertices, determining the length of the least-cost path.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Populate a field, &#39;dist_calc&#39; with the distance.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;[sourcecode]
CREATE OR REPLACE FUNCTION bulk_route_generate() RETURNS VOID AS $$
DECLARE
bld_row bld_wtastops_staging5%ROWTYPE;
dist_calc RECORD;
BEGIN
RAISE NOTICE &#39;Beginning Function&#39;;
FOR bld_row IN SELECT * FROM bld_wtastops_staging5 WHERE bld_wtastops_staging5.bld_vert_node IS NOT NULL
AND bld_wtastops_staging5.wtastops_vert_node IS NOT NULL
-- BEGIN ADDING BUM NODES TO SKIP OVER
AND bld_wtastops_staging5.bld_vert_node &amp;lt;&amp;gt; 2915
AND bld_wtastops_staging5.wtastops_vert_node &amp;lt;&amp;gt; 293
-- ADD START GID
-- USED ONLY IF BUM NODES EXIST
--AND bld_wtastops_staging5.bld_gid &amp;gt;= 29200
ORDER BY bld_wtastops_staging5.bld_gid LOOP
RAISE NOTICE &#39;Value of wtastops_vert_node is %. The value of bld_vert_node is %&#39;,bld_row.wtastops_vert_node, bld_row.bld_vert_node;
RAISE NOTICE &#39;Value of wtastops_gid is %. The value of bld_gid is %&#39;,bld_row.wtastops_gid, bld_row.bld_gid;
-- BEGIN STANDARD pgRouting A*Star FUNCTION
SELECT SUM(cost) INTO dist_calc FROM shortest_path_astar(&#39;
SELECT gid as id,
source::integer,
target::integer,
length::double precision as cost,
x1, y1, x2, y2
FROM streets_9102748&#39;,
bld_row.bld_vert_node, bld_row.wtastops_vert_node, false, false);
RAISE NOTICE &#39;Value of dist_calc is %.&#39;,dist_calc;
EXECUTE &#39;UPDATE bld_wtastops_staging5
SET route_dist = &#39; ||dist_calc|| &#39;
WHERE &#39; ||bld_row.bld_gid|| &#39; = bld_wtastops_staging5.bld_gid&#39;;
END LOOP;
-- BAIL OUT ON ERRORS
EXCEPTION
WHEN CONTAINING_SQL_NOT_PERMITTED THEN
RAISE NOTICE &#39; EXECPTION Value of wtastops_vert_node is %. The value of bld_vert_node is %&#39;,bld_row.wtastops_vert_node, bld_row.bld_vert_node;
END;
$$ LANGUAGE &#39;plpgsql&#39;;
-- EXECUTE FUNCTION
SELECT bulk_route_generate();
[/sourcecode]&lt;/p&gt;
&lt;p&gt;I&#39;m excited at the possibilities that using PL/pgSQL offers in terms of manipulating data. I&#39;m sure that the above function can be cleaned up quite a bit, too. If I ever have the need to re-visit this or similar problems, I&#39;ll be sure to do some serious head-scratching to think about a better approach!&lt;/p&gt;
&lt;p&gt;Here is an image of the resulting data generated using &lt;a href=&quot;http://mapnik.org/&quot;&gt;mapnik&lt;/a&gt;. Areas from dark green to light-green are within a 1/4 mile distance, while areas from yellow-to-red represent distances increasingly greater then a 1/4 mile. The large checkered areas are where the dataset failed to route. More on that at another time.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_360&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;430&amp;quot; caption=&amp;quot;the result as seen in mapnik&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/06/bld_sym_diverging_web.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/06/bld_sym_diverging_web.png&quot; alt=&quot;bld_sym_diverging_web&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>pgRouting III: PHP + OpenLayers Interface</title>
		<link href="https://mattmakesmaps.com/blog/2010-02-06-pgrouting-iii-php-openlayers-interface/"/>
		<updated>2010-02-06T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2010-02-06-pgrouting-iii-php-openlayers-interface/</id>
		<content type="html">&lt;p&gt;With the routing &lt;a href=&quot;http://www.mkgeomatics.com/wordpress/?p=312&quot;&gt;database configured and populated&lt;/a&gt;, and with &lt;a href=&quot;http://www.mkgeomatics.com/wordpress/?p=322&quot;&gt;geoserver rendering the WMS&lt;/a&gt;, now the focus can shift on designing the actual display and functionality.&lt;/p&gt;
&lt;p&gt;The conceptual plan is as follows: &lt;!-- more --&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Extract the geometry of a user&#39;s click on the map.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Pass the extracted geometry to a PHP script, via an HTTP GET request.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Use the PHP script to pass the geometry as part of an SQL query against the PostGIS/pgRouting database.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Return the geometry from the database as &lt;a href=&quot;http://geojson.org/&quot;&gt;GeoJSON&lt;/a&gt;, and deserialize it into an OpenLayers vector layer feature.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The code to extract a user&#39;s clicked coordinates was taken from &lt;a href=&quot;http://openlayers.org/dev/examples/click.html&quot;&gt;this&lt;/a&gt; OpenLayers example. It was then modified to pass the xy coordinates to a second function, designed to create a URL which will execute a PHP script.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;javascript&amp;quot;]trigger: function(e) {
var xy = map.getLonLatFromViewPortPx(e.xy);
executeSQL(xy);
}[/sourcecode]&lt;/p&gt;
&lt;p&gt;Passing the XY variable to the executeSQL() function, we are able to now seperate out the individual X and Y coordinates, and apply them to their respective parameters in our URL string.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;javascript&amp;quot;]// Build the URL
var json_url = &amp;quot;http://localhost/near_vertex_astar.php?&amp;quot;;
json_url += &amp;quot;x=&amp;quot; + escape(xy.lon);
json_url += &amp;quot;&amp;amp;y=&amp;quot; + escape(xy.lat);[/sourcecode]&lt;/p&gt;
&lt;p&gt;Having constructed the URL, we are now ready to use it to populate an OpenLayers vector layer with data.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;javascript&amp;quot;]// Make a fresh vector layer, pulling features from our script URL
json_layer = new OpenLayers.Layer.Vector(&amp;quot;GeoJSON&amp;quot;, {
styleMap: myStyles,
strategies: [new OpenLayers.Strategy.Fixed()],
protocol: new OpenLayers.Protocol.HTTP({
url: json_url,
format: new OpenLayers.Format.GeoJSON()
})
});[/sourcecode]&lt;/p&gt;
&lt;p&gt;Alright! So where are we at right now? A user has clicked the map, and that click&#39;s geometry has been extracted and sent to a PHP script on the server for further work. The PHP script will execute SQL in the PostGIS/pgRouting data base to do the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Find the closest vertex in our routing network to the user&#39;s map click. This will be used as a source vertex.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Find all firestations within 5km of the vertex (which have been pre-attributed with the closest vertex on the routing network to their location).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Calculate the cost (as defined by total length of the route) from the source vertex to each fire station (really the routing network vertex).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Return back as GeoJSON only the geometry for the route with the lowest cost.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Why all the hassle with determining the cost? Can&#39;t you just use PostGIS&#39; ST_DWithin() function to find the closet firestation to our user&#39;s click and create the route? Well you could, but it might not always be the shortest route.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_339&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Euclidean distance versus Manhattan. Which one is shorter?&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/02/distance.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/02/distance-300x279.png&quot; alt=&quot;Euclidean distance versus Manhattan. Which one is shorter?&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;This behavior can be respresented in the routing network with the example below. Two different routes are generated from the same source vertex based on the combination of routing algorithm and account for route cost. On the left, the &lt;a href=&quot;http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm&quot;&gt;dijkstra algorithm&lt;/a&gt; is used to return the route to the closest fire station as the result of an ST_DWithin() query. On the right, the A-Star algorithm is used, and the route costs of all fire stations within a buffer are taken into account. As we can see, a different route and a different station are returned.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/02/dj_left_astar_right1.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/02/dj_left_astar_right1-1024x338.png&quot; alt=&quot;Comparing the two search algorithms and cost relationships.&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;A link to the JS and PHP scripts can be found at the end of this post. This definitely is not the most elegant solution to working with routing, but in terms of an experiment it was a great learning exercise. I&#39;m really excited to dive deeper into PostGIS and pgRouting. The next step in the process will be incorporating OSM data, and adding in addition attributes which affect cost (speed limits, one-way streets, etc).&lt;/p&gt;
&lt;p&gt;View the &lt;a href=&quot;http://mkgeomatics.com/apps/syntaxhighlighter/astar_php.html&quot;&gt;PHP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;View the &lt;a href=&quot;http://mkgeomatics.com/apps/syntaxhighlighter/astar.html&quot;&gt;OL JS&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>pgRouting Part II: PostGIS + Geoserver</title>
		<link href="https://mattmakesmaps.com/blog/2010-01-31-pgrouting-part-ii-postgis-geoserver/"/>
		<updated>2010-01-31T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2010-01-31-pgrouting-part-ii-postgis-geoserver/</id>
		<content type="html">&lt;p&gt;Since compiling &lt;a href=&quot;http://pgrouting.postlbs.org/&quot;&gt;Orkney&#39;s pgRouting extension&lt;/a&gt; to PostgreSQL/PostGIS, I&#39;ve decided to try my hand at creating a simple web interface to poke into the database. The current setup is as follows: &lt;!-- more --&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Display: OpenLayers&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Renderer: Geoserver (via non-cached WMS)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Spatial Backend: PostGIS/pgRouting enabled PostgreSQL&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Data: &lt;a href=&quot;http://www.cob.org/services/maps/gis/index.aspx&quot;&gt;Public GIS data&lt;/a&gt; from the city of Bellingham, Washington&#39;s GIS department.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the sake of brevity, (but really because both TOPP has created some &lt;a href=&quot;http://workshops.opengeo.org/opengeo-stack/&quot;&gt;fantastic guides&lt;/a&gt;) I won&#39;t go into the specifics of installing all the pieces. Just as an FYI, remember to set your &#39;JAVA_HOME&#39; environment variable and make sure that you don&#39;t have things trying to use the same port!&lt;/p&gt;
&lt;p&gt;The Bellingham data is currently stored in &lt;a href=&quot;http://www.spatialreference.org/ref/esri/102748/&quot;&gt;NAD83 State Plane WA North Feet&lt;/a&gt;, a typical projection for this area. This projection however, is not part of the EPSG projection set, and as such is not included in a vanilla install of PostGIS.&lt;/p&gt;
&lt;p&gt;In order to add this to the collection of spatial reference systems used by my PostGIS install, I went with the ridiculously cool &lt;a href=&quot;http://spatialreference.org&quot;&gt;spatialreference.org&lt;/a&gt; site (A &lt;a href=&quot;http://crschmidt.net/&quot;&gt;crschmidt&lt;/a&gt;, &lt;a href=&quot;http://dbsgeo.com/&quot;&gt;dbsgeo&lt;/a&gt;, &lt;a href=&quot;http://hobu.biz/&quot;&gt;hobu&lt;/a&gt;, and &lt;a href=&quot;http://umbrellaconsulting.com/&quot;&gt;umbrella&lt;/a&gt; joint, hah). Navigating to the projection&#39;s page gives me the option to generate an &lt;a href=&quot;http://www.spatialreference.org/ref/esri/102748/postgis/&quot;&gt;INSERT&lt;/a&gt; statement, adding the projection&#39;s info into my database.&lt;/p&gt;
&lt;p&gt;To load shapefiles into the PostGIS database, I chose to use the SPIT plugin for QGIS. Loading the data was fairly straightforward. I had an issue with a datefield that was present in the source shapefile, and had to delete the column manually using Open Office Database. I haven&#39;t found a way to delete fields from a shapefile using QGIS.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_327&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;The SPIT Interface&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/spit.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/spit-300x175.png&quot; alt=&quot;spit&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;After uploading the streets data into my PostGIS database, the next step was to transform the geometry into the Web Mercator 900913 Projection. This was done using standard PostGIS functions, adding a new, second, geometry column to the existing streets table. This reprojected data was then exported from my staging PostGIS database as a shapefile using the QGIS, &#39;Save As Shapefile&#39; tool, and re-imported into my production database (with the routing functions).&lt;/p&gt;
&lt;p&gt;With data stored in the web mercator projection, inside of our PostGIS/pgRouting database, the next step was to add the layers to Geoserver. Using Geoserver 2.x, the process included the following steps (all done through the web-admin).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Add the new data store pointing the PostGIS database.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add new layers (resources) which point to the tables of interest in our PostGIS database.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After creating the connections between PostGIS and Geoserver, the creation of WMS services is taken care of, allowing us to roll them into OpenLayers with relative ease.&lt;/p&gt;
&lt;p&gt;I guess this got a little off-topic from what I originally wanted to write about. I think that I&#39;ll save the actual breakdown of my OL code (taking a user&#39;s map click to and using it to calculate a route to the nearest fire-station as determined by manhattan distance, as opposed to euclidean distance) for another day.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>pgRouting On Ubuntu Netbook Remix 9.10</title>
		<link href="https://mattmakesmaps.com/blog/2010-01-11-pgrouting-on-ubuntu-netbook-remix-9-10/"/>
		<updated>2010-01-11T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2010-01-11-pgrouting-on-ubuntu-netbook-remix-9-10/</id>
		<content type="html">&lt;p&gt;While working through Regina Obe and Leo Hsu&#39;s &lt;a href=&quot;http://www.postgis.us&quot;&gt;PostGIS In Action&lt;/a&gt; I thought that I&#39;d jump into the world of routing. My plan was to develop a sample application that could be used to plan bicycle routes throughout the city of Seattle. A quick google search proved that someone has already done it, and done it very well! &lt;a href=&quot;http://www.ridethecity.com/&quot;&gt;http://www.ridethecity.com/&lt;/a&gt; provides cycling routes using OSM data for many major cities, Seattle included. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Undeterred and inspired, i decided to compile the &lt;a href=&quot;http://pgrouting.postlbs.org/&quot;&gt;pgRouting&lt;/a&gt; set of tools for PostGIS and give them a whirl.&lt;/p&gt;
&lt;p&gt;My primary tutorial for moving through the install and execution of functions came from the 2009 FOSS4G Tokyo &amp;amp; Osaka workshop entitled, &amp;quot;&lt;a href=&quot;http://www.google.com/url?sa=t&amp;amp;source=web&amp;amp;ct=res&amp;amp;cd=7&amp;amp;ved=0CCMQFjAG&amp;amp;url=http%3A%2F%2Fwww.osgeo.jp%2Fwordpress%2Fwp-content%2Fuploads%2F2009%2F11%2Fworkshop_manual.pdf&amp;amp;ei=4vdLS63EKIGSsgPFrsGIDA&amp;amp;usg=AFQjCNEoTXqRqtS8fpDXbNLo6H2Nk3cEyg&amp;amp;sig2=RLw7qVqUev7k8pdvzCjXeQ&quot;&gt;FOSS4G routing with pgRouting tools and OpenStreetMap road data.&lt;/a&gt;&amp;quot; Although my installation on Ubuntu Netbook Remix (UNR) 9.10 required a little different setup, this guide definitely got me 99% of the way there.&lt;/p&gt;
&lt;p&gt;The majority of my installation woes were caused by the different pathways used on my UNR install of PostgreSQL vs. what are apparently the standard paths.&lt;/p&gt;
&lt;p&gt;After attempting to execute cmake to compile pgRouting, I&#39;d be presented with an error stating that the &#39;POSTGRESQL_INCLUDE_DIR&#39; was not found. A locate command pointed me to the correct path for my PostgreSQL installation. By modifying the FindPostgreSQL.cmake file to search for the correct path, I was back in business.&lt;/p&gt;
&lt;p&gt;Following the workshop instructions, I then attempted to create the database directly from the terminal, which yielded the following result.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;bash&amp;quot;]matt@matt-netbook:~$ createdb -U postgres routing
createdb: could not connect to database postgres: could not connect to server: No such file or directory
Is the server running locally and accepting
connections on Unix domain socket &amp;quot;/var/run/postgresql/.s.PGSQL.5432&amp;quot;?[/sourcecode]&lt;/p&gt;
&lt;p&gt;After reading the documentation associated with &amp;quot;createdb&amp;quot;, i tried adding the &amp;quot;-h&amp;quot; flag pointing to &amp;quot;localhost&amp;quot;, which solved the problem.&lt;/p&gt;
&lt;p&gt;The final error which I ran into had to do with the &amp;quot;$libdir&amp;quot; environment variable. While trying to register the pgRouting functions in my new database, I&#39;d be presented with the following:&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;bash&amp;quot;]psql:/usr/share/postlbs/routing_core.sql:32: ERROR: could not access file &amp;quot;$libdir/librouting&amp;quot;: No such file or directory
psql:/usr/share/postlbs/routing_core.sql:43: ERROR: could not access file &amp;quot;$libdir/librouting&amp;quot;: No such file or directory
psql:/usr/share/postlbs/routing_core.sql:53: ERROR: could not access file &amp;quot;$libdir/librouting&amp;quot;: No such file or directory[/sourcecode]&lt;/p&gt;
&lt;p&gt;Getting impatient at this point (i wanted to route!) I modified the SQL files to reference the explicit path of my PostgreSQL lib directory. Once that was done, I had a working routing database!&lt;/p&gt;
&lt;p&gt;Loading the sample data, creating the indexes, and executing the queries was amazingly straightforward. To test visualizing the data, I exported one of the tutorial queries directly into a new table.&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;SQL&amp;quot;]SELECT * INTO export
FROM dijkstra_sp(&#39;ways&#39;, 10, 20);[/sourcecode]&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_316&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;The route depicted in red as seen in QGIS.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/qgis_routing.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/qgis_routing-300x175.png&quot; alt=&quot;qgis_routing&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Just for kicks, I tried exporting the data as GeoJSON and visualzing it via OpenLayers.&lt;/p&gt;
&lt;p&gt;The following SQL query aggregates the exported line segments into a single GeoJSON object:&lt;/p&gt;
&lt;p&gt;[sourcecode language=&amp;quot;SQL&amp;quot;]SELECT ST_AsGeoJSON(ST_UNION(the_geom)) AS geom_union
FROM export;[/sourcecode]&lt;/p&gt;
&lt;p&gt;Using the &lt;a href=&quot;http://openlayers.org/dev/examples/vector-formats.html&quot;&gt;vector-formats&lt;/a&gt; OL example, which displays GeoJSON in either EPSG 4326 or 102113, I was able to visualize the line segment with no problem.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_317&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;GeoJSON representation of line segment generated using pgRouting, displayed in OpenLayers&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/openlayers_vector_formats.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2010/01/openlayers_vector_formats-300x175.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Well that&#39;s all for one day. So it looks like the bike riding app is out, but I&#39;m sure that there will be many more interesting ideas for pgRouting that will come to mind as I continue to explore PostGIS.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>ESRI UC Student Assistant, Sweet!</title>
		<link href="https://mattmakesmaps.com/blog/2009-04-27-esri-uc-student-assistant-sweet/"/>
		<updated>2009-04-27T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-04-27-esri-uc-student-assistant-sweet/</id>
		<content type="html">&lt;p&gt;Just found out that I&#39;ll be participating in the 2009 ESRI UC as a student assistant. Big thanks go out to &lt;a href=&quot;http://geography.asu.edu/balling&quot;&gt;Dr. Robert Balling&lt;/a&gt; and &lt;a href=&quot;http://www.spatiallyadjusted.com/&quot;&gt;James Fee&lt;/a&gt;, who both wrote letters of recommendation for me.&lt;/p&gt;
&lt;p&gt;Now to get back to more pressing matters, like refactoring this giant wad o&#39; javascript. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;See you in San Deigo!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Visualizing An Existing MySQL Database</title>
		<link href="https://mattmakesmaps.com/blog/2009-04-22-visualizing-an-existing-mysql-database/"/>
		<updated>2009-04-22T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-04-22-visualizing-an-existing-mysql-database/</id>
		<content type="html">&lt;p&gt;So I&#39;ve been working for about a month with a fairly-normalized (53-table) database in which I draw out all kinds of tabular information, and display it in a spatial context. This has required the numerous multiple table joins, with all kinds of weird relationships... you know, the kind that usually don&#39;t work out very well? &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;In any event, my SOP for handling these queries was to submit sample data through the codeigniter site that our project&#39;s web developer has been courageously firing away at. In this sense, I&#39;d sort-of trace the flow of new information through the various tables of the database, monitoring the information stream as best as I could. I thought to myself, that there has to be a better way to handle this stuff! In comes the &lt;a href=&quot;http://dev.mysql.com/workbench/&quot;&gt;MySQL Workbench&lt;/a&gt;. This handy tool from the &lt;a href=&quot;http://dev.mysql.com/&quot;&gt;MySQL Dev Zone&lt;/a&gt; apparently comes in two flavors: FOSS and commercial.&lt;/p&gt;
&lt;p&gt;The free version served my visualization needs perfectly. The layout of the program is very solid. I was easily able to take an SQL export of the existing database and import it into the Workbench, through a tool they call &#39;Reverse Engineer MySQL Create Script&#39;. Once the schema has been injected into the program, a model can be automatically created containing all of the tables as well as relationships. The auto-layout feature however, leaves a lot to be desired.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_293&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Automatic Layout Results, Snazzy!&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/initial_layout.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/initial_layout-300x189.jpg&quot; alt=&quot;Above: Automatic Layout Results, Snazzy!&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;After about twenty-minutes of fooling with the table graphics, a usable layout can be produced. One feature that I think is really convenient, but will never use, is the automatic setting of the diagram width and height based on numbers of pages. This is useful for those who need a quick-print out of their database for whatever reason.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_292&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Workbench w/ Completed Diagram&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/workspace.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/workspace-300x187.jpg&quot; alt=&quot;Above: Workbench w/ Completed Diagram&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;The real benefit for me however, is the automatic highlighting of key values linking tables together. I&#39;m now able to quickly work my way from the table I need to get to, drilling backwards until I see the table I need to start with.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_294&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Automatically Highlight The Key Fields Between Two Tables.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/linking_tables.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/linking_tables-300x147.jpg&quot; alt=&quot;Above: Automatically Highlight The Key Fields Between Two Tables.&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>MetaCarta&#39;s Map Rectifier + ESRI DevSummit Mashup Winner :)</title>
		<link href="https://mattmakesmaps.com/blog/2009-04-08-metacartas-map-rectifier-esri-devsummit-mashup-winner/"/>
		<updated>2009-04-08T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-04-08-metacartas-map-rectifier-esri-devsummit-mashup-winner/</id>
		<content type="html">&lt;p&gt;I never knew about the &lt;a href=&quot;http://labs.metacarta.com/rectifier/&quot;&gt;MetaCarta Labs&#39; Map Rectifier&lt;/a&gt; tool, but I&#39;ll expect to be using it more in the future. After uploading an image to the site, a user has full control over the creation of Ground Control Points. The advanced nature of this tool is shown though included RMS error reporting as well as the choice between multiple transformation algorithms. &lt;!-- more --&gt; In addition to uploading your own content, a user has the ability to add GCPs for other users&#39; uploads as well.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Image Removed.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;What&#39;s really amazing is the ability to directly access rectified images via WMS overlay. Each image hosted on the site is given a unique URL, we can insert into our favorite web mapping clients.&lt;/p&gt;
&lt;p&gt;To try it out, I used the &lt;a href=&quot;http://resources.esri.com/arcgisserver/apis/javascript/gmaps/index.cfm?fa=codeGalleryDetails&amp;amp;scriptID=16067&quot;&gt;ExtMap - Mashup Framework&lt;/a&gt; developed by ArcGIS user &lt;a href=&quot;http://resources.esri.com/arcgisserver/apis/javascript/gmaps/index.cfm?fa=codeGallery&amp;amp;authorID=alperdincer&quot;&gt;alperdincer&lt;/a&gt;. This particular application framework was one of the winners at 2009 ESRI DevSummit, with good reason. I was able to quickly pass in the MetaCarta Labs URL, allowing the ExtMap application to consume and display the WMS layer with ease.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Image Removed.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;In addition to WMS layers, we can add in KML/GeoRSS as well as ArcGIS Server Dynamic/Tiled Map Layers.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Archived Post. Image Removed.&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Easy as pie? Piece of Cake? Yes. It&#39;s innovative projects like these that keep pushing me to learn more about web mapping technology. Big thanks go out to crschmidt (who i assumed was involved w/ the project) at MetaCarta and &lt;a href=&quot;http://resources.esri.com/arcgisserver/apis/javascript/gmaps/index.cfm?fa=codeGallery&amp;amp;authorID=alperdincer&quot;&gt;alperdincer&lt;/a&gt; for putting together two great products.&lt;/p&gt;
&lt;p&gt;On a final note, the MetaCarta Rectifier has the ability to export out images as geotiffs, allowing us to consume them in our desktop GIS applications. A quick check in ArcCatalog of the Chernobyl sample image I exported out revealed a WGS84 GCS. I can see some really nice workflows combining this tool with tiling programs such as &lt;a href=&quot;http://www.klokan.cz/projects/gdal2tiles/&quot;&gt;GDAL2Tiles&lt;/a&gt; for painless TMS creation.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>CloudMade Tile Request Graphics</title>
		<link href="https://mattmakesmaps.com/blog/2009-04-07-cloudmade-tile-request-graphics/"/>
		<updated>2009-04-07T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-04-07-cloudmade-tile-request-graphics/</id>
		<content type="html">&lt;p&gt;I just found a neat feature from CloudMade, a &lt;a href=&quot;http://maps.cloudmade.com/stats/tile_requests&quot;&gt;heat map&lt;/a&gt; showing intensity of their tile requests at each zoom scale. As can be expected, Europe and North America are the definite zones of high activity. It&#39;s also interesting to note the high activity in other regions such as Chile and the Philippines. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_272&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: CloudMade&#39;s Tile Request Graphic&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/cm_tile_request.jpg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/04/cm_tile_request-300x187.jpg&quot; alt=&quot;Above: CloudMade&#39;s Tile Request Overlay&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Following the link to the &lt;a href=&quot;http://maps.cloudmade.com/javascripts/stats/cloudmade.js?1238766232&quot;&gt;stats JavaScript&lt;/a&gt;, it looks like they are using a custom OpenLayers layer class, OpenLayers.Layer.Cloudmade. Sweet!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>SpatialLite: My First Look</title>
		<link href="https://mattmakesmaps.com/blog/2009-04-05-spatiallite-my-first-look/"/>
		<updated>2009-04-05T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-04-05-spatiallite-my-first-look/</id>
		<content type="html">&lt;p&gt;With such a small footprint (a single file) &lt;a href=&quot;http://www.gaia-gis.it/spatialite/&quot;&gt;SpatialLite&lt;/a&gt; appears to a novice like myself to be a fantastic niche storage solution for spatial data. In an environment where installing larger FOSS databases such as MySQL or PostGIS/PostgreSQL can be prohibitive, Spatial Lite appears to provide a great solution. Using the provided GUI interface, &lt;!-- more --&gt; it&#39;s extremely easy for a first-time user to create an sqllite dbase, load multiple shapefiles, and create spatial indexes against them. Analogous to a FOSSGIS ESRI Geodatabase, I can see a lot of potential uses for GIS developers who require the indexing and searching power of a database as well as the portability of formats such as an ESRI Shapefile or KML.&lt;/p&gt;
&lt;p&gt;It looks like a &lt;a href=&quot;http://geobabble.wordpress.com/2009/03/26/spatiallite-support-in-qgis/&quot;&gt;QGIS connection&lt;/a&gt; is in the works for the 1.1 release as well.&lt;/p&gt;
&lt;p&gt;I&#39;m not sure if it&#39;s already being done, but I&#39;d bet that it would be pretty easy to put together a SpatialLite / &lt;a href=&quot;http://featureserver.org/&quot;&gt;FeatureServer&lt;/a&gt; combination, considering its native support for so many spatial-backends.&lt;/p&gt;
&lt;p&gt;Some tutorials I&#39;ve found to be very helpful have come from: &lt;a href=&quot;http://www.bostongis.com/PrinterFriendly.aspx?content_name=spatialite_tut01&quot;&gt;BostonGIS&lt;/a&gt; and the &lt;a href=&quot;http://www.gaia-gis.it/spatialite/spatialite-2.2_tutorial.html&quot;&gt;SpatialLite project site&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>ArcGIS REST API / OpenLayers / Unit Testing = Fun In The Sun</title>
		<link href="https://mattmakesmaps.com/blog/2009-03-13-arcgis-rest-api-openlayers-unit-testing-fun-in-the-sun/"/>
		<updated>2009-03-13T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-03-13-arcgis-rest-api-openlayers-unit-testing-fun-in-the-sun/</id>
		<content type="html">&lt;p&gt;Until today, I had never truly appreciated the value of unit testing. I recently had the need to bring &lt;a href=&quot;http://dev.openlayers.org/sandbox/august/openlayers/openlayers-2.6/examples/ags/index.html&quot;&gt;these ArcGIS REST controls&lt;/a&gt;, designed for version 2.6 of OpenLayers, into the current development version. Having no real idea how to get started on this process, I looked to the unit tests as a guide &lt;!-- more --&gt; to what needed to be changed. One might be asking why this was necessary, when the team over at Avencia just put together a great &lt;a href=&quot;http://trac.openlayers.org/ticket/1749&quot;&gt;ArcGIS REST Plugin&lt;/a&gt; that has made its way into the trunk for the upcoming 2.8 release. The answer is that both plugins do different things well. The older AGSControls can perform &#39;Identify&#39; and &#39;Geoprocessing&#39; operations rather well, while the Avencia plugin does a great job at displaying and querying a subset of a layer resource.&lt;/p&gt;
&lt;p&gt;In any event, the &lt;a href=&quot;http://straytree.com/TestAnotherWay/doc/index.html&quot;&gt;Test.AnotherWay&lt;/a&gt; suite, used by OpenLayers, provides an easy-to-navigate interface for debugging javascript code.&lt;/p&gt;
&lt;p&gt;In two steps I was able to begin the debugging process.&lt;/p&gt;
&lt;p&gt;First, adding the unit test for the AGSControl to the &#39;list-tests.html&#39; file located in the &#39;tests&#39; folder of a development version of OpenLayers. This unit test, written by the developer, needs to manually downloaded and incorporated into the standard series of tests that come with OpenLayers. As we can see from the image below, this particular test was written as an html file and placed into the &#39;Control&#39; sub-directory of the &#39;tests&#39; directory.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_256&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;224&amp;quot; caption=&amp;quot;Above: Adding a link to the unit test for use by Test.AnotherWay&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/list_test.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/list_test.png&quot; alt=&quot;Adding a link to the unit test for use by Test.AnotherWay&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;After adding the test, we open up &#39;run-tests.html&#39; in the browser and select &#39;AgsControl&#39; from the list. After the test has executed, the results are provided to us. With the red light of failure burning bright, we might think to abandon all hope. We are, however, given the cause and location of the failure, an invaluable clue as to where to start debugging. Time to soldier on.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_257&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Unit Test Failure&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/ags_fail.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/ags_fail-300x98.png&quot; alt=&quot;Above: Unit Test Failure&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Using these test results as a road map, even I can eventually debug a plugin. The green light of success offers a reassuring reminder that all is well in the GIS world.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_259&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Successful Unit Test&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/ags_success1.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/03/ags_success1-300x112.png&quot; alt=&quot;Above: Successful Unit Test&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;I&#39;ve taken away a few things from this experience. Firstly, I&#39;m again deeply impressed by the time and effort that developers in the Open Source community are putting into these projects. The only reason that I could even dream of modifying any of this source code is due to the fact that the developer of the AGSControls provided such detailed unit tests. These allowed me to wrap my brain around what was going on with the code, and how it could be updated. Taking the time to not only write code, but to also provide tools so that others can understand it and modify it with ease is something that I think I&#39;ll always be impressed with. And of course, I&#39;ll be continuing to rely on unit tests as debugging tools as i continue my exploration of javascript programming.&lt;/p&gt;
&lt;p&gt;In the words of &lt;a href=&quot;http://www.davebouwman.net/&quot;&gt;Dave Bouwman&lt;/a&gt;, who has a whopping fourteen posts in his tag cloud on the subject:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Unit testing is quite possibly the single best practice for ensuring that your code is bug free (or very nearly bug free!).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;His &#39;fundamentals&#39; article provides a great introduction on the subject: which can be read &lt;a href=&quot;http://www.davebouwman.net/fundamentals/unittesting.aspx&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Google Motion Charts: From Data To Information </title>
		<link href="https://mattmakesmaps.com/blog/2009-01-31-google-motion-charts-from-data-to-information/"/>
		<updated>2009-01-31T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-01-31-google-motion-charts-from-data-to-information/</id>
		<content type="html">&lt;p&gt;I&#39;ve been playing with the motion chart gadget in Google&#39;s AJAX API Playground recently, and have found it to be an extremely interesting tool to use. In order to produce data rich charts, all that is necessary is to import a tabular datasheet into google docs and call on it within a javascript function. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;The spreadsheet itself requires:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;The first column be entity data (place names, events, etc.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The second column to be formatted as &#39;Date&#39;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The third and following columns to contain your chart-worthy data.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A simple example can be found below depicting historical weather station information for three cities in the Western United States. This information was downloaded from the &lt;a href=&quot;http://www.wrcc.dri.edu/&quot;&gt;Western Regional Climate Center&lt;/a&gt; and imported manually into a &lt;a href=&quot;http://spreadsheets.google.com/ccc?key=pPDD5D7AqVH0jefmgJwF9OQ&quot;&gt;google docs spreadsheet&lt;/a&gt;. As we can see, we have a variety of different ways to explore the data, and hopefully, synthesize them into useful information for decision makers in a best case scenario.&lt;/p&gt;
&lt;p&gt;Above: Markers indicate the cities in which weather station data was collected.&lt;/p&gt;
&lt;p&gt;Above: Google Motion Chart Gadget. NOTE: The data are actually compiled monthly averages from 1971-2000. For the sake of simplicity however, i fed the date column in a format of &#39;Jan-1&#39; which turns out automatically appends the current year. The proper date should read for example, &#39;1/1&#39; rather than &#39;1/1/09&#39;.&lt;/p&gt;
&lt;p&gt;In any event, in a data rich GIS environment, we can easily succumb to &#39;data overload&#39;. This creates a barrier for decision makers in understanding their situations, and as such can lead to poor planning. Through the careful use of data visualization tools such as this, however, decision makers can be empowered to quickly analyze data in a variety of ways, creating useful information on-the-fly and without the use of specialized GIS technical know-how.&lt;/p&gt;
&lt;p&gt;At least I think that&#39;s how it works.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>OSM &#39;Minutely&#39; Tile Updates: Thanks CloudMade!</title>
		<link href="https://mattmakesmaps.com/blog/2009-01-24-osm-minutely-tile-updates-thanks-cloudmade/"/>
		<updated>2009-01-24T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-01-24-osm-minutely-tile-updates-thanks-cloudmade/</id>
		<content type="html">&lt;p&gt;Another great OSM Mapping Party is underway in Tempe Arizona. Brandon of &lt;a href=&quot;http://www.cloudmade.com/&quot;&gt;CloudMade&lt;/a&gt; came out to run the show, with local hosting by &lt;a href=&quot;http://www.spatiallyadjusted.com/&quot;&gt;James Fee&lt;/a&gt; of RSP Architects. Coffee, pizza, libations, and Open Source GIS provided a great foundation for lively discussion on the practical and philosophical aspects that OpenStreetMaps provides. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Of particular interest was a question posed by a first time OSM&#39;er, who wondered why we had to wait a week for the tiles to render, just to see the results of some type of experiment that we might be trying out in the digitization and attribution of features in the map. Well, no one could really give him a good answer other then, &#39;it&#39;s just the way it is&#39;.&lt;/p&gt;
&lt;p&gt;It appears though, that CloudMade has provided us with an answer just the other day. The &lt;a href=&quot;http://matt.sandbox.cloudmade.com/&quot;&gt;Minutely Updated Tile Server&lt;/a&gt; is updated &#39;every minute from OpenStreetMap diffs&#39;. The results can be seen below. The first image depicts the standard weekly update view while the bottom image depicts the minutely render. Note the presence of the additional buildings on ASU&#39;s Tempe Campus.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_241&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: OSM Weekly Update&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/weekly.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/weekly-300x242.jpg&quot; alt=&quot;Above: OSM Weekly Update&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_242&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: CloudMade&#39;s Minutely Updated Tile Server for OSM&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/minutely.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/minutely-300x240.jpg&quot; alt=&quot;Above: CloudMade&#39;s Minutely Updated Tile Server for OSM&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Check out the full post from CloudMade&#39;s blog here: &lt;a href=&quot;http://blog.cloudmade.com/2009/01/23/nearly-live-tiles/&quot;&gt;http://blog.cloudmade.com/2009/01/23/nearly-live-tiles/&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Geocoding with OpenLayers: A Crash Course In Firebug</title>
		<link href="https://mattmakesmaps.com/blog/2009-01-20-geocoding-with-openlayers-a-crash-course-in-firebug/"/>
		<updated>2009-01-20T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2009-01-20-geocoding-with-openlayers-a-crash-course-in-firebug/</id>
		<content type="html">&lt;p&gt;The vacation is over. A new job and a new semester are already providing plenty of opportunities to explore those crazy technologies of the geoweb.&lt;/p&gt;
&lt;p&gt;A need to incorporate the &lt;a href=&quot;http://developer.yahoo.com/maps/rest/V1/geocode.html&quot;&gt;Yahoo Geocoder&lt;/a&gt; into a new OpenLayers app has proved to be a great learning experience in the navigation of the development version of OL. &lt;!-- more --&gt; The &lt;a href=&quot;http://trac.openlayers.org/ticket/1784&quot;&gt;YahooGeocoder.js&lt;/a&gt; addin, created by OL community member, &#39;sbenthall&#39;, requires two prerequisites to run: A &lt;a href=&quot;http://trac.openlayers.org/wiki/FrequentlyAskedQuestions#ProxyHost&quot;&gt;proxy.cgi script&lt;/a&gt; as well as a Yahoo Developer API key. Why would this RESTful service require a proxy, you might find yourself asking? Well, because even though you can query it in a RESTful fashion, the data is returned in an XML shell, requiring a proxy to allow complete the XMLHttpRequest. Yahoo has a great article for novice web programmers like myself explaining the role of Web Proxies, which can be found &lt;a href=&quot;http://developer.yahoo.com/javascript/howto-proxy.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A quick overview of the primary steps to add the YahooGeocoder.js addin are as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Sign up for a Yahoo APP Key to enable access to their geocoding service.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add the proxy.cgi script to your webserver&#39;s &#39;cgi-bin&#39;. Note: When navigating to the proxy.cgi&#39;s url, you might encounter, &#39;access denied&#39; errors. If you do, make sure that you have the proper permissions set for your cgi-bin directory. This can be done using the terminal command, &#39;chmod 755&#39; targeting cgi-bin directory.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Edit the proxy.cgi script to include &#39;local.yahooapis.com&#39; in the list of &#39;allowedHosts&#39;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_228&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Modified &#39;proxy.cgi&#39;&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/proxy_hosts.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/proxy_hosts-300x54.png&quot; alt=&quot;proxy_hosts&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;
&lt;p&gt;Add the YahooGeocoder.js file to the OpenLayers &#39;lib/OpenLayers/Control&#39; folder.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add &amp;quot;OpenLayers/Control/YahooGeocoder.js&amp;quot; to the variable array, &#39;jsfiles&#39; inside the &amp;quot;lib/OpenLayers.js&amp;quot; library.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_229&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Modified &#39;lib/OpenLayers.js&#39;&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/control_add.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/control_add-300x149.png&quot; alt=&quot;control_add&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;Test the geocoder&#39;s functionality using the supplied .HTML file. (Hopefully it should work!)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_230&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Geocoder Result with Properly Formed XML Response.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/good_xml_return1.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/good_xml_return1-300x217.png&quot; alt=&quot;good_xml_return1&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Six simple steps, but it can be challenging if you haven&#39;t tried to install any addins to the OL library before.&lt;/p&gt;
&lt;p&gt;In the above image, the firebug window can be seen returning a properly formed XML Response, having successfully executed the geocoding function. If you enlarge the image, we can compare this to the raw XML-Response using a properly constructed query. Note in both the response captured from firebug (above) as well as the raw XML (below) the presence of the address: 510 High Street, Bellingham WA, broken down into it&#39;s individual units along with the geocoded result.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_231&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Basic XML Return&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/basic_xml.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/basic_xml-300x221.png&quot; alt=&quot;basic_xml&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Further diving into the capabilities of firebug, we can use the DOM inspector to ensure that the various parameters required to properly execute the Yahoo Geocoder are in place. Note in the image below the presence of such necessary information as the APP ID Key, Projection, and Class, for the ygc variable. If any of these parameters happened to be incorrectly set, it would be displayed in this view.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_232&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: The Firebug DOM Inspector&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/dom_inspector.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2009/01/dom_inspector-300x91.png&quot; alt=&quot;dom_inspector&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;I&#39;m finally starting to appreciate the power of firebug as a development tool, which just so happens to coincide with my ability to understand it at a basic level. Hopefully as my experience in GIS Web Development grows, so will be ability to use the higher-end functions of this tool.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>TMS: Shaded Relief for OSM Data (An Adventure and A 1/2)</title>
		<link href="https://mattmakesmaps.com/blog/2008-12-20-tms-shaded-relief-for-osm-data-an-adventure-and-a-12/"/>
		<updated>2008-12-20T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-12-20-tms-shaded-relief-for-osm-data-an-adventure-and-a-12/</id>
		<content type="html">&lt;p&gt;After reading &lt;a href=&quot;http://stamen.com/&quot;&gt;Michal Migurski&#39;s&lt;/a&gt; excellent post, &#39;&lt;a href=&quot;http://mike.teczno.com/notes/hillshading.html&quot;&gt;making friends with hillshading&lt;/a&gt;&#39; I decided to try my own hand at producing a TMS-compatible hillshade layer for OSM. Motivated by both the high resolution LiDAR data which I happen to have access to, and the lack of access to ArcDesktop during the winter intersession... I set out on the FOSSGIS path. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_205&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;259&amp;quot; caption=&amp;quot;The resulting overlay&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/apps/openlayers/tiles/ol_working.html&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-1-259x300.png&quot; alt=&quot;The resulting overlay&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;The final output was created in a primarily two-step process. The hillshade was created using Matt Perry&#39;s &lt;a href=&quot;http://www.perrygeo.net/wordpress/?p=7&quot;&gt;GDAL DEM tools&lt;/a&gt;. This command line addition to the GDAL suite of tools negated having to import the DEM into a new GRASS location, and exporting the resulting hillshade back out as another format.&lt;/p&gt;
&lt;p&gt;The majority of the work, the tiling that is, was done using &lt;a href=&quot;http://www.klokan.cz/projects/gdal2tiles/&quot;&gt;GDAL2Tiles&lt;/a&gt;. This Google Summer of Code project operates under a command line utility which will take your slick GDAL-compatible raster dataset as input, and export a set of tiles exactly to your specs. What&#39;s more is the capability to automatically generate google maps and OpenLayers viewing pages which can be directly uploaded to a webspace.&lt;/p&gt;
&lt;p&gt;Finally, applying a slight transparency to the OSM layer allowed for the shaded relief to appear from behind. Quick-and-Dirty, &lt;a href=&quot;http://mkgeomatics.com/apps/openlayers/tiles/ol_working.html&quot;&gt;but it works&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;The pain came when trying to compare the local TMS overlay using OSM vs. Google Maps base data. While using Google Maps street data, we clearly see the LiDAR building footprints align with the vector street centerlines. But switching over to OSM data, we see a drastic skew between the two.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_206&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Google Street Data: Properly Aligned Local TMS&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-21.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-21-300x209.png&quot; alt=&quot;Google Street Data: Properly Aligned Local TMS&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_209&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;OSM Data: Note Hawaii Belt Road&#39;s location compared to its LiDAR footprint.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-4.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-4-300x297.png&quot; alt=&quot;OSM Data: Note Hawaii Belt Rd&#39;s location compared to its LiDAR footprint.&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Initially, I assumed that the problem was the result of some projection issues (EPSG: 4326 vs EPSG: 900913), until I realized that all data sets (LiDAR, Google, and OSM) had matching coastlines. Any distortion resulting from the affine transformation between WGS84 and Spherical Mercator would have clearly showed up along the coast as well as the streets.&lt;/p&gt;
&lt;p&gt;A quick look at the &lt;a href=&quot;http://wiki.openstreetmap.org/wiki/Potlatch&quot;&gt;Potlatch&lt;/a&gt; editor revealed the inaccuracy of the TIGER line files used in this section of the map:&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_210&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Potlatch: TIGER data is a good, but not great.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/potlatch.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/potlatch-300x273.png&quot; alt=&quot;Potlatch: TIGER data is a good, but not great.&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;All-in-all I was extremely impressed with the speed and efficency of using the &lt;a href=&quot;http://www.perrygeo.net/wordpress/?p=7&quot;&gt;GDAL DEM Tools&lt;/a&gt; as well as &lt;a href=&quot;http://www.klokan.cz/projects/gdal2tiles/&quot;&gt;GDAL2Tiles&lt;/a&gt;. Both projects are great representations of what can be done by individuals who choose to build upon existing FOSSGIS projects, and give back to the community.&lt;/p&gt;
&lt;p&gt;Additional Note:
A GRASS-based approach to creating a TMS layer is possible, and has been outlined in &lt;a href=&quot;https://mattmakesmaps.com/blog/2008-12-20-tms-shaded-relief-for-osm-data-an-adventure-and-a-12/sunbird.jrc.it/pvgis/doc/paper/2008_OSGeo5_TiledMapServices.pdf&quot;&gt;this paper&lt;/a&gt; appearing in the OSGeo Journal.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>OSM Recap</title>
		<link href="https://mattmakesmaps.com/blog/2008-12-08-osm-recap/"/>
		<updated>2008-12-08T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-12-08-osm-recap/</id>
		<content type="html">&lt;p&gt;What an awesome weekend. There was a good turnout for the Phoenix OSM mapping party, put on by &lt;a href=&quot;http://www.cloudmade.com/&quot;&gt;CloudMade&lt;/a&gt; and hosted locally by &lt;a href=&quot;http://gangplankhq.com/&quot;&gt;Gangplank&lt;/a&gt;. On both days we saw a mixture of GIS professionals and Open Source users come out to support the project. A new neologism to add to the list also came out of the event, &#39;crowdsourcing&#39;. &lt;!-- more --&gt; The work of many locals who have an inherent expert knowledge of their surrounding environment replacing the work of what would otherwise be performed by a few skilled professionals.&lt;/p&gt;
&lt;p&gt;Here is the result of our work:&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_199&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: ASU Mapping Party&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/export.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/export-300x225.png&quot; alt=&quot;ASU Mapping Party&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;In any event, we decided to focus our efforts on ASU&#39;s campus for the weekend. Before we went out with GPS units, an OSM&#39;er named &#39;jfuredy&#39; had actually taken a stab at some rooftop digitization of buildings along campus. I&#39;ve already noticed that there are inherent conflicts that occur by digitizing from rooftops. Tall buildings of course, will appear oblique, with their roofs offset from their actual footprints. This creates scenarios in which buildings (created from oblique angled rooftops) are overlapping walkways.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_200&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;215&amp;quot; caption=&amp;quot;Above: Digitization Conflict&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-2.png&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/picture-2.png&quot; alt=&quot;Above: Digitization Conflict&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;I&#39;m excited to continue working on the OSM project, and hope to see more mapping parties in the future. Speaking with &lt;a href=&quot;http://cloudmade.com/team/brandon-aguirre&quot;&gt;Brandon&lt;/a&gt;, our contact at CloudMade, I mentioned that the end of January could be a potential date. This would be the first week of the new semester for MAS-GIS, and hopefully more of the students will come out and support the project!&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>OpenStreetMap.org Mapping Party This Weekend</title>
		<link href="https://mattmakesmaps.com/blog/2008-12-04-openstreetmaporg-mapping-party-this-weekend/"/>
		<updated>2008-12-04T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-12-04-openstreetmaporg-mapping-party-this-weekend/</id>
		<content type="html">&lt;p&gt;&lt;a href=&quot;http://www.meetup.com/OpenStreetMap-Phoenix/&quot;&gt;http://www.meetup.com/OpenStreetMap-Phoenix/&lt;/a&gt; It&#39;s going to rock. It really is.&lt;/p&gt;
&lt;p&gt;Having just heard of OSM a little over a month ago, and using their tiles for about two weeks now... I&#39;m really excited to give back to the OSM community. In a way, it&#39;s a chance for those who have never committed code to a FOSS project (like me) to really add some positive input back &lt;!-- more --&gt; into a community that we are a part of, if only in a small way. But hey, if we are all contributing small bits to the project-at-large... it&#39;ll add up. A little &#39;&lt;a href=&quot;http://en.wikipedia.org/wiki/Neogeography&quot;&gt;neogeography&lt;/a&gt;&#39;, anyone?&lt;/p&gt;
&lt;p&gt;Additionally, I have put together a small tool to compare the current OSM offerings to that of various commercial mapping vendors (Google, Microsoft VE). Pretty fun exploration of the OpenLayers API!&lt;/p&gt;
&lt;p&gt;Check it out here: &lt;a href=&quot;http://mkgeomatics.com/apps/openlayers/osm_compare.html&quot;&gt;http://mkgeomatics.com/apps/openlayers/osm_compare.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_196&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: Quick and Dirty OSM Tool&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/osm_tool.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/12/osm_tool-300x244.jpg&quot; alt=&quot;Above: Quick and Dirty OSM Tool&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Stefan Steinger - FOSS Desktop GIS Overview</title>
		<link href="https://mattmakesmaps.com/blog/2008-12-01-stefan-steinger-foss-desktop-gis-overview/"/>
		<updated>2008-12-01T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-12-01-stefan-steinger-foss-desktop-gis-overview/</id>
		<content type="html">&lt;p&gt;Found via the Cascadia Users of Geospatial Open Source (&lt;a href=&quot;http://groups.google.com/group/cugos&quot;&gt;CUGOS&lt;/a&gt;) website.&lt;/p&gt;
&lt;p&gt;Very recent paper accepted by the International Journal of Geographical Information Science depitcs the current state of the art in FOSS Desktop GIS and much more. The staying power in the article however, IMHO, is the detailed explanation of the various FOSS license agreements &lt;!-- more --&gt; which exist and the organisations which play a major role in the development of FOSSGIS as a whole. One of the most interesting tidbits for me was the realization that the Open Geospatial Consortium cannot be equated directly to the FOSSGIS movement.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A couple of people to which we spoke related the activities of the Open Geospatial Consortium (OGC, www.opengeospatial.org) to open source GIS software. This link is not entirely correct, since the OGC is an organisation that develops standards for the processing and exchange of geo-data between different GIS platforms. Furthermore a large portion of the member organisations of the OGC, besides universities and authorities, are companies that develop proprietary GIS and Databases.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Link: &lt;a href=&quot;http://cugos.googlegroups.com/web/sstein_foss_desktop_gis_overview.pdf&quot;&gt;http://cugos.googlegroups.com/web/sstein_foss_desktop_gis_overview.pdf&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Spherical Mercator / New Portfolio</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-30-spherical-mercator-new-portfolio/"/>
		<updated>2008-11-30T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-30-spherical-mercator-new-portfolio/</id>
		<content type="html">&lt;p&gt;In the continuing adventures of my WFS example, I&#39;ve now added spherical mercator capabilities to the PROJ.4 library, following those instructions &lt;a href=&quot;http://crschmidt.net/&quot;&gt;Chris Schmidt&lt;/a&gt; gave me last week. On the fly reprojection of the data allows for the incorporation of numerous proprietary vendors, such as Google Maps and Microsoft Virtual Earth, as well as open source tile services such as OpenStreetMaps.org. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_185&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: WFS Spherical Mercator Reprojection with Google Terrain Base Layer&amp;quot;]&lt;a href=&quot;http://mkgeomatics.com/apps/openlayers/spherical_merc.html&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wfs_spherical-300x298.jpg&quot; alt=&quot;Above: WFS Spherical Mercator Reprojection with Google Terrain Base Layer&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;Feel free to check it out: &lt;a href=&quot;http://mkgeomatics.com/apps/openlayers/spherical_merc.html&quot;&gt;http://mkgeomatics.com/apps/openlayers/spherical_merc.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In other news, I&#39;m also nearly finished moving my portfolio from WWU&#39;s servers to this site. One can click on the Portfolio link to the right, or simply navigate directly to a sub-section if they choose.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>ScapeToad - Open Source Cartogram Generator</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-23-scapetoad-open-source-cartogram-generator/"/>
		<updated>2008-11-23T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-23-scapetoad-open-source-cartogram-generator/</id>
		<content type="html">&lt;p&gt;&lt;a href=&quot;http://chorogram.choros.ch/scapetoad/index.php&quot;&gt;ScapeToad&lt;/a&gt; provides an amazingly easy to use interface for creating cartograms. Accepting shapefiles directly as input, it has a wide variety of fine-tunable settings in addition to its presets. The ability to utilize multiple layers as weights also seems like a pretty exciting feature. Written entirely in java, it&#39;s platform-independent, another plus for mac and / or linux GIS users. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_127&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: The counties of Washington State.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wa.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wa-300x202.jpg&quot; alt=&quot;WA_Green&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;What is so cool about this program is that not only does it use shapefiles as an input, but it generates shapefiles as output as well. A SizeError attribute is also generated to allow a user to easily control map symbology using GIS software. In addition to this, one can also export as an SVG directly to use in a graphics editor.&lt;/p&gt;
&lt;p&gt;The cartogram below was generated using the percentage of a county&#39;s total area covered by state routes. The lighter colors indicate a smaller distortion in size while the darker colors indicate a larger distortion in size. Note the I-5 corridor in Western Washington is heavily affected using this criteria.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_128&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Above: The result. &amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/cartogram2.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/cartogram2-300x212.jpg&quot; alt=&quot;WA_Cartogram&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;ScapeToad - &lt;a href=&quot;http://chorogram.choros.ch/scapetoad/index.php&quot;&gt;http://chorogram.choros.ch/scapetoad/index.php&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Data (WA DOT) - &lt;a href=&quot;http://www.wsdot.wa.gov/&quot;&gt;http://www.wsdot.wa.gov/&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Attribution, CSS, and IRC</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-22-attribution-css-and-irc/"/>
		<updated>2008-11-22T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-22-attribution-css-and-irc/</id>
		<content type="html">&lt;p&gt;I&#39;ve built up the &lt;a href=&quot;http://www.mkgeomatics.com/apps/openlayers/WA_WFS_WGS84_query.html&quot;&gt;WFS OpenLayers example&lt;/a&gt; I&#39;ve been working on to now include attribution (by hovering over a feature) as well as a pointless select feature capability. Click away! It won&#39;t do anything but, that&#39;s fine. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;A different baselayer is also available, &lt;a href=&quot;http://www.openstreetmap.org/&quot;&gt;openstreetmaps.org&lt;/a&gt; (via telascience.org tiles). You may notice that some of these tiles fail to reload upon panning and zooming operations. I asked why this was on the OpenLayers IRC, and was told that these tiles basically suck. I&#39;m stuck using them however, as they are Lat/Long WGS84. OSM Mapnik and Google maps require a spherical mercator projection, and as such PROJ.4 needs to be amended to support this EPSG code so that Mapserver and render properly.&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_121&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;Screenshot of simple WFS example&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wfs_example.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wfs_example-300x276.jpg&quot; alt=&quot;Screenshot of simple WFS example&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;It &lt;a href=&quot;http://docs.openlayers.org/spherical_mercator/#mapserver&quot;&gt;looks pretty straightforward&lt;/a&gt;, but another project for another day.&lt;/p&gt;
&lt;p&gt;In any event, I&#39;ve kept the OpenLayers WMS as the primary base layer, which doesn&#39;t have display issues.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>whew...</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-21-whew/"/>
		<updated>2008-11-21T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-21-whew/</id>
		<content type="html">&lt;p&gt;This took a &#39;lot&#39; longer than i expected.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mkgeomatics.com/apps/openlayers/WA_WFS_WGS84.html&quot;&gt;http://www.mkgeomatics.com/apps/openlayers/WA_WFS_WGS84.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Calling Mapserver as a WFS layer, displaying with OpenLayers. Many thanks to &lt;a href=&quot;http://crschmidt.net/&quot;&gt;Chris Schmidt&lt;/a&gt; for a quick response on the OL mailing list! &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Currently set to extract attributes in the OL html, but still need to build in the attribute display. A good example of the necessary javascript can be found in the &lt;a href=&quot;http://openlayers.org/dev/examples/openmnnd.html&quot;&gt;OL Cookbook&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I also set a quick thank you to Jeff McKenna at &lt;a href=&quot;http://www.gatewaygeomatics.com/&quot;&gt;Gateway Geomatics&lt;/a&gt; for putting together such a great set of UMN Mapserver WFS and WMS tutorials. He actually wrote back! oh FOSS4G, what a nice community.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Happy GIS Day.</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-19-happy-gis-day/"/>
		<updated>2008-11-19T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-19-happy-gis-day/</id>
		<content type="html">&lt;p&gt;all across the world, little GIS themed cookies and cakes will be consumed...&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>WMS To WFS</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-18-wms-to-wfs/"/>
		<updated>2008-11-18T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-18-wms-to-wfs/</id>
		<content type="html">&lt;p&gt;The main goal for today is figuring out what is going on with &lt;a href=&quot;http://mkgeomatics.com/apps/FWTools-2.0.6/bin_safe/mapserv.cgi?map=/home/matthewkenny/mkgeomatics.com/apps/FWTools-2.0.6/mapdata/WA/WA_NAD83UTM10N.map&amp;amp;MODE=MAP&quot;&gt;my WFS demo&lt;/a&gt;. I&#39;ve got it a Mapserver mapfile up and running, and can load each layer individually by calling the service in either QGIS or ArcGIS. The mapfile was tweaked to WFS metadata specs via this &lt;a href=&quot;http://mapserver.gis.umn.edu/docs/howto/wfs_server&quot;&gt;extremely helpful tutorial&lt;/a&gt;. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;If we take a look at the DescribeFeatureType() results for &lt;a href=&quot;http://mkgeomatics.com/apps/FWTools-2.0.6/bin_safe/mapserv.cgi?map=/home/matthewkenny/mkgeomatics.com/apps/FWTools-2.0.6/mapdata/WA/WA_WGS84.map&amp;amp;SERVICE=WFS&amp;amp;VERSION=1.0.0&amp;amp;REQUEST=DescribeFeatureType&quot;&gt;my WFS&lt;/a&gt; query (I don&#39;t know if I should be calling it a WFS at this point, but I will...) we see that no tabular information is being extracted from the shapefiles.&lt;/p&gt;
&lt;blockquote&gt;
&lt;schema targetNamespace=&quot;http://mapserver.gis.umn.edu/mapserver&quot; elementFormDefault=&quot;qualified&quot; version=&quot;0.1&quot;&gt;
&lt;/schema&gt;&lt;/blockquote&gt;
&lt;import namespace=&quot;http://www.opengis.net/gml&quot; schemaLocation=&quot;http://schemas.opengis.net/gml/2.1.2/feature.xsd&quot;&gt;

&lt;p&gt;compare this to the DMSolutions WFS DescribeFeatureType() &lt;a href=&quot;http://www2.dmsolutions.ca/cgi-bin/mswfs_gmap?SERVICE=WFS&amp;amp;VERSION=1.0.0&amp;amp;REQUEST=DescribeFeatureType&quot;&gt;request&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;schema targetNamespace=&quot;http://www.ttt.org/myns&quot; elementFormDefault=&quot;qualified&quot; version=&quot;0.1&quot;&gt;
&lt;/schema&gt;&lt;/blockquote&gt;
&lt;import namespace=&quot;http://www.opengis.net/gml&quot; schemaLocation=&quot;http://schemas.opengeospatial.net/gml/2.1.2/feature.xsd&quot;&gt;
&lt;element name=&quot;prov_land&quot; type=&quot;myns:prov_landType&quot; substitutionGroup=&quot;gml:_Feature&quot;&gt;

&lt;complexType name=&quot;prov_landType&quot;&gt;

&lt;complexContent&gt;

&lt;extension base=&quot;gml:AbstractFeatureType&quot;&gt;

&lt;sequence&gt;
&lt;element name=&quot;msGeometry&quot; type=&quot;gml:GeometryPropertyType&quot; minOccurs=&quot;0&quot; maxOccurs=&quot;1&quot;&gt;
&lt;element name=&quot;AREA&quot; type=&quot;string&quot;&gt;
&lt;element name=&quot;PERIMETER&quot; type=&quot;string&quot;&gt;
&lt;element name=&quot;PROVINCE_&quot; type=&quot;string&quot;&gt;
...
&lt;p&gt;I&#39;m thinking that there is more work which needs to be done in the mapfile. My guess is that it has to do with the &#39;gml_featureid&#39; and &#39;gml_include_items&#39; metadata information.&lt;/p&gt;
&lt;p&gt;whatever&#39;s clever.&lt;/p&gt;
&lt;/element&gt;&lt;/element&gt;&lt;/element&gt;&lt;/element&gt;&lt;/sequence&gt;&lt;/extension&gt;&lt;/complexContent&gt;&lt;/complexType&gt;&lt;/element&gt;&lt;/import&gt;&lt;/import&gt;</content>
	</entry>
	
	<entry>
		<title>WFS!</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-18-wfs/"/>
		<updated>2008-11-18T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-18-wfs/</id>
		<content type="html">&lt;p&gt;Wow, i actually have a working WFS server now. I was able to successfully use QGIS to call upon the same mapfile using both &#39;WMS&#39; and &#39;WFS&#39; service types. As you can see in the image below, a static baselayer, &#39;COUNTY&#39; (actually a dissolved shp designed to show the physical outline of Washington State) is displayed as WMS layer, as well as WFS layer, &#39;NATPARK&#39;, capable of actually identifiying features. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;[caption id=&amp;quot;attachment_97&amp;quot; align=&amp;quot;alignnone&amp;quot; width=&amp;quot;300&amp;quot; caption=&amp;quot;QGIS Screenshot: Selected feature in yellow, Identified feature in pinkish-outline.&amp;quot;]&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wfs_identify.jpeg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/11/wfs_identify-300x221.jpg&quot; alt=&quot;wfs_identify&quot;&gt;&lt;/a&gt;[/caption]&lt;/p&gt;
&lt;p&gt;I&#39;m amazed at the ability of Mapserver to take a shapefile, turn it into GML, and send it almost magically to ANY program that can interpret it. I&#39;m finally wrapping my noggin around the whole concept of XML, and just how powerful it can be.&lt;/p&gt;
&lt;p&gt;So what were my primary issues? Well, it took me about an hour to realize that I was running my, &#39;DescribeFeatureType&#39; request on the mapfile entitled &#39;WA_WGS84.map&#39; rather than &#39;WA_WFS_WGS84.map&#39;. So that was my own error. Then I realized that while the KEY field for each of these shapefiles in ArcGIS is simply, &#39;FID&#39;, this **cannot **be used for the &#39;gml_featureid&#39; metadata requirement in the mapfile. Another primary key such as, &#39;PARKID&#39; must instead be used, and the GML file will actually create its own, &#39;FID&#39; based on this.&lt;/p&gt;
&lt;p&gt;Some other key lessons from today:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ESRI ArcGIS does not support WFS out of the box, as it does WMS. To enable the GML simple features profile, try out this &lt;a href=&quot;http://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?id=5607&amp;amp;pid=5604&amp;amp;topicname=Using_the_GML_simple_features_profile&quot;&gt;ESRI Help Article&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Querying your WFS server in-browser using the, &#39;getfeature&#39; and &#39;getcapabilities&#39; requests is a really simple and effective way of determining which required pieces of information are missing from your XML. Mapserver will actually create a comment in-line saying which required pieces of metadata are missing.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Creating metadata abstracts for both WFS and WMS in your mapfile is a simple way to view how your GIS software is consuming the data. For example, the only reason i realized that I was actually using QGIS to display my WFS mapfile as a WMS was through the use both of the &amp;quot;wms_abstract&amp;quot; and &amp;quot;wfs_abstract&amp;quot; metadata tags.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What&#39;s next? Wrap an openlayers display around this with selection and identify capabilities.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Mapserver [Update]</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-16-mapserver-update/"/>
		<updated>2008-11-16T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-16-mapserver-update/</id>
		<content type="html">&lt;p&gt;Well, using the &lt;a href=&quot;http://openlayers.org/dev/examples/&quot;&gt;OpenLayers Cookbook&lt;/a&gt; I&#39;ve been able to modify OpenLayers to display base data from Google and their own World WMS layer. That is all for now. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Viewing the source code might not give you too much insight as to what is going on... it&#39;s looking pretty haggard at this point. I&#39;ll get around to cleaning it up and adding comments (mainly so I can learn something about what is going on, hah).&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Mapserver Up and Running</title>
		<link href="https://mattmakesmaps.com/blog/2008-11-15-73/"/>
		<updated>2008-11-15T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-11-15-73/</id>
		<content type="html">&lt;p&gt;Well, after about a month of no progress in the Web GIS realm, i&#39;ve finally got some progress to show! The openlayers map you are looking at below is consuming information from a Mapserver WMS, running on this site. In case you&#39;re also wondering, the data being displayed is actually a &lt;a href=&quot;http://www.cob.org/services/maps/index.aspx&quot;&gt;shapefile&lt;/a&gt; of the neighborhoods of beautiful Bellingham, WA. &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;This gets me back to where I was as part of my senior GIS project, with the very large exception that the data is being hosted 24/7 on a shared host, rather than an ubuntu-powered laptop on death&#39;s door. Well, &#39;what is the difference?&#39; one might ask. Well, instead of having to tell someone, &#39;Hey, you interested person, sure you can view my WMS server. I&#39;ll turn my laptop on between the hours of 3-5PM. If the connection is slow, it could be because my wi-fi is dropping out. Or maybe because my roommates are playing Halo 3 on Xbox Live? Or maybe I&#39;m watching a movie on netflix?&#39; In any event, reliability is a plus.&lt;/p&gt;
&lt;p&gt;So what got me over this hurtle? Well, it just so happens that instead of compiling all of these programs from the source, you can just install &lt;a href=&quot;http://fwtools.maptools.org/&quot;&gt;FWTools&lt;/a&gt; as an entire package right onto your website. Neat! As Aaron Racicot also pointed out in &lt;a href=&quot;http://www.mail-archive.com/mapserver-users@lists.umn.edu/msg13520.html&quot;&gt;some post&lt;/a&gt;, it&#39;s necessary to add the, &#39;.cgi&#39; extension to the mapserv file, as dreamhost (my current hosting choice) requires the extension to be explicitly set.&lt;/p&gt;
&lt;p&gt;This really opens the door to quite a bit of experimentation using OpenLayers and Mapserver together.&lt;/p&gt;
&lt;p&gt;On a final note, compiling all those programs from source has had an added benefit not attainable with FWTools. That is, the use of command-line GRASS. Who knows when they&#39;ll be stuck, needing to do some GIS w/o an ArcDesktop install, &lt;em&gt;but&lt;/em&gt; with an SSH terminal?&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Nested Tuples and Hours of Patience</title>
		<link href="https://mattmakesmaps.com/blog/2008-10-03-nested-tuples-and-hours-of-patience/"/>
		<updated>2008-10-03T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-10-03-nested-tuples-and-hours-of-patience/</id>
		<content type="html">&lt;p&gt;I&#39;ve finally got a working python script that does the following:&lt;/p&gt;
&lt;p&gt;-Reads each of the vertexes of a polyline shapefile using &#39;OGR&#39;&lt;/p&gt;
&lt;p&gt;-Runs the vertexes through the Douglas-Peucker smoothing algorithm.&lt;/p&gt;
&lt;p&gt;-Generates an output text file using &#39;stdout&#39; with the resulting &#39;smoothed&#39; coordinates (in whatever linear unit of measurement that the source shapefile happens to be in).&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;This has taken quite awhile to get this far, but it has been an excellent learning experience. The breakthrough for tonight was understanding that the Douglas-Peucker algorithm which I downloaded from mappinghacks required a nested tuple as an input. Basically then, I needed to figure out how translate the extracted vertexes from the source shapefile into the tuple object.&lt;/p&gt;
&lt;p&gt;Things started to go bad, really bad, when I attempted to create formatted output files for the extracted vertexes... and re-import them as input files for the DP algorithm. It&#39;s all good now though, and the code looks (a bit) cleaner.&lt;/p&gt;
&lt;p&gt;The next step will be to take this output text file and build another shapefile from it...&lt;/p&gt;
&lt;p&gt;Here is a link to the heavily commented &lt;a href=&quot;http://www.mkgeomatics.com/scripts/dp_100308.py&quot;&gt;script&lt;/a&gt; (right-click, select &#39;save-as&#39;) as it stands thus-far.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>I&#39;m Obsessed With Douglas-Peucker</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-30-im-obsessed-with-douglas-peucker/"/>
		<updated>2008-09-30T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-30-im-obsessed-with-douglas-peucker/</id>
		<content type="html">&lt;p&gt;The Problem: Web map vector overlays take a really long time to load if there are too many verticies.&lt;/p&gt;
&lt;p&gt;The Idea: Use the Douglas-Peucker algorithm to reduce the number of verticies thereby decreasing load time.&lt;/p&gt;
&lt;p&gt;The [Proposed] Solution: Using a version of the Douglas-Peucker algorithm written in Python, input a source shapefile, and output a smoothed shapefile through the following steps. This script currently uses board coordinates, and as such, is not &#39;spatially&#39; enabled. The trick is to make it except shapefiles as an input source.&lt;/p&gt;
&lt;!-- more --&gt;
&lt;p&gt;-Extract each of the verticies using ogrinfo, pipe to grep, and export to output csv file.
$ogrinfo -al input_polyline.shp | grep linestring | tr -d &amp;quot;LINESTRING()&amp;quot; &amp;gt; output.csv&lt;/p&gt;
&lt;p&gt;-Reformat the verticies [somehow], so that they can be readable to the python script.&lt;/p&gt;
&lt;p&gt;-Rebuild shapefile from output csv with projection information using GDAL/OGR.&lt;/p&gt;
&lt;p&gt;So my plan is to essentially to break down the shapefile, smooth it, and build it back up again, using open source tools. We&#39;ll see how far this goes.&lt;/p&gt;
&lt;p&gt;Some reading:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm&quot;&gt;Douglas-Peucker Algorithm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://users.ox.ac.uk/~orie1848/tutorial.html&quot;&gt;Existing GRASS Implementation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://webhelp.esri.com/arcgisdesktop/9.2/index.cfm?id=530&amp;amp;pid=513&amp;amp;topicname=Simplifying_and_smoothing_features&quot;&gt;Existing ArcGIS Implementation&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
	</entry>
	
	<entry>
		<title>Web-Based GRASS!</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-14-web-based-grass/"/>
		<updated>2008-09-14T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-14-web-based-grass/</id>
		<content type="html">&lt;p&gt;Whoo-hoo! After a number of tweaks, I finally was able to install command-line GRASS GIS onto this site. I&#39;ve been working off of Aaron Racicot&#39;s &lt;a href=&quot;http://www.reprojected.com/geoblog/how-tos/gis-on-a-shared-hosting-environment-the-magic-of-not-having-root/&quot;&gt;tutorial&lt;/a&gt; for about a week now. Actually being able to understand and fix some of the errors in the ./configure process is feeling pretty rewarding. I had to manually set the pathways for FFTW and TK using --with-fftw-includes and --with-tclktk-includes respectively. Also, ran into &lt;!-- more --&gt; an issue with NAD2BIN not being explicitly laid out as well, but I was lucky enough to find a forum post stating that I needed to use the command, &#39;export NAD2BIN=/home/.../bin/nad2bin&#39;.&lt;/p&gt;
&lt;p&gt;I&#39;m not all that familiar with the command line syntax of GRASS, so I actually had to use a local install to view some sample syntax, and modify it for use on the web instance. Pretty fun.&lt;/p&gt;
&lt;p&gt;I&#39;m wondering if there is anyway for a user to access the geoprocessing functionality of this GRASS install w/o logging into the server. Furthermore, could it be possible to tie this into a mapserver / openlayers install? It would be amazing to recreate this &lt;a href=&quot;http://resources.esri.com/help/9.3/arcgisserver/apis/javascript/arcgis/help/jssamples_start.htm#jssamples/GPviewShed.html&quot;&gt;ESRI on-the-fly geoprocessing example&lt;/a&gt; using only open source GIS tools.&lt;/p&gt;
&lt;p&gt;Anyways, it&#39;s a pretty cool feeling to be able to upload a file to the server, run a geoprocessing task on it, and download the results back to my machine!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;GRASS 6.2.3 (spearfish):~/usr/local/bin &amp;gt; r.shaded.relief map=elevation.dem shadedmap=shade_test altitude=30 azimuth=270 zmult=2 scale=1
Calculating shading, please stand by.
100%
Color table for [shade_test] set to grey&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Shaded relief map created and named [shade_test].
GRASS 6.2.3 (spearfish):~/usr/local/bin &amp;gt; r.out.tiff input=shade_test output=/home/matthewkenny/usr/local/gis_workspace/shade_out compression=none
WARNING: The map &amp;lt;shade_test&amp;gt; in mapset &lt;user1&gt; is a floating point map.
Decimal values will be rounded to integer!
GRASS 6.2.3 (spearfish):~/usr/local/bin &amp;gt;&lt;/user1&gt;&lt;/p&gt;
&lt;p&gt;And the output image downloaded back to my computer:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/09/shade_out.jpg&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/09/shade_out-300x225.jpg&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/09/shade_out.tif&quot;&gt;&lt;img src=&quot;http://www.mkgeomatics.com/wordpress/wp-content/uploads/2008/09/shade_out.tif&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Python GP Strangeness</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-14-python-gp-strangeness/"/>
		<updated>2008-09-14T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-14-python-gp-strangeness/</id>
		<content type="html">&lt;p&gt;I had to explicitly set the workspace, list the ASCII files, THEN link the two into a single variable for use in the ASCIIToRaster tool. I could have sworn that all I needed to do was to pass along the ASCII variable right into the ASCIIToRaster tool, and it would automatically carry the file path along with it. Maybe that is only the case when you are working with fields, rather than rasters / feature classes?&lt;/p&gt;
&lt;!-- more --&gt;
&lt;pre class=&quot;language-python&quot; tabindex=&quot;0&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#Batch Convert ASCII to ESRI GRID&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Matthew Kenny&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#September 14, 2008&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#############################################################&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Import the arcgisscripting module&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; sys&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; arcgisscripting

&lt;span class=&quot;token comment&quot;&gt;# Create the Geoprocessor object&lt;/span&gt;
gp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; arcgisscripting&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Set the workspace&lt;/span&gt;
gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;workspace &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;F:/!South_Kona/DEM_XYZ_Tiled/Area1/Group5/ASCII/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# get list of all the ASCII files in the workspace&lt;/span&gt;
asciiList &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ListRasters&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;*DEM*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asciiList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Starting with &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Set initial INPUT file&lt;/span&gt;
inputAscii &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;workspace &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; inputAscii

&lt;span class=&quot;token comment&quot;&gt;# Set initial OUTPUT file&lt;/span&gt;
raster &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;workspace &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/GRID/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.img&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; raster

&lt;span class=&quot;token comment&quot;&gt;# loop through list of feature classes&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Execute ASCII to Raster&lt;/span&gt;
    gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ASCIIToRaster_conversion&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inputAscii&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; raster&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INTEGER&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;File &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; raster&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; has been created.&quot;&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asciiList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Moving onto &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;
    inputAscii &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;workspace &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;new inputAscii: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; inputAscii
    raster &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;workspace &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/GRID/&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;.img&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;new output Raster: &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; raster
&lt;span class=&quot;token builtin&quot;&gt;ascii&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asciiList&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reset&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;#remove geoprocessor object from memory&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;del&lt;/span&gt; gp&lt;/code&gt;&lt;/pre&gt;
</content>
	</entry>
	
	<entry>
		<title>GDAL / PROJ.4 On Shared Webhost</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-12-gdal-proj4-on-shared-webhost/"/>
		<updated>2008-09-12T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-12-gdal-proj4-on-shared-webhost/</id>
		<content type="html">&lt;p&gt;For the past couple of days, I&#39;ve been putting hours into understanding Aaron Racicot&#39;s, &#39;&lt;a href=&quot;http://www.reprojected.com/geoblog/how-tos/gis-on-a-shared-hosting-environment-the-magic-of-not-having-root/&quot;&gt;guide to GIS on a shared hosting service&lt;/a&gt;&#39;. This has been a great learning experience in working w/ SSH and a full mapserver install from the source. My goal is to host a Mapserver WMS directly from this site. I&#39;ve got everything in place... probably not configured correctly, probably full of errors, probably will never work (w/o a healthy dose of patience).&lt;/p&gt;
&lt;p&gt;I do however, know that I am on the right track, as GDAL/OGR and PROJ.4 are up and running.&lt;/p&gt;
&lt;!-- more --&gt;
&lt;blockquote&gt;
&lt;p&gt;[gotti]$ ./ogrinfo -al -so /home/matthewkenny/usr/local/shp_samples/county_polygon.shp
INFO: Open of &lt;code&gt;/home/matthewkenny/usr/local/shp_samples/county_polygon.shp&#39; using driver &lt;/code&gt;ESRI Shapefile&#39; successful.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Layer name: county_polygon
Geometry: Polygon
Feature Count: 39
Extent: (576751.628593, 81877.320813) - (2551197.698864, 1355595.418907)
Layer SRS WKT:
PROJCS[&amp;quot;NAD_1983_HARN_StatePlane_Washington_South_FIPS_4602_Feet&amp;quot;,
GEOGCS[&amp;quot;GCS_North_American_1983_HARN&amp;quot;,
DATUM[&amp;quot;NAD83_High_Accuracy_Regional_Network&amp;quot;,
SPHEROID[&amp;quot;GRS_1980&amp;quot;,6378137.0,298.257222101]],
PRIMEM[&amp;quot;Greenwich&amp;quot;,0.0],
UNIT[&amp;quot;Degree&amp;quot;,0.0174532925199433]],
PROJECTION[&amp;quot;Lambert_Conformal_Conic_2SP&amp;quot;],
PARAMETER[&amp;quot;False_Easting&amp;quot;,1640416.666666667],
PARAMETER[&amp;quot;False_Northing&amp;quot;,0.0],
PARAMETER[&amp;quot;Central_Meridian&amp;quot;,-120.5],
PARAMETER[&amp;quot;Standard_Parallel_1&amp;quot;,45.83333333333334],
PARAMETER[&amp;quot;Standard_Parallel_2&amp;quot;,47.33333333333334],
PARAMETER[&amp;quot;Latitude_Of_Origin&amp;quot;,45.33333333333334],
UNIT[&amp;quot;Foot_US&amp;quot;,0.3048006096012192]]
COUNTY_COD: Integer (2.0)
COUNTY_FIP: String (3.0)
COUNTY_NM: String (15.0)
ECY_REGION: String (4.0)
AIR_REGION: String (46.0)
[gotti]$&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Plans</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-08-plans/"/>
		<updated>2008-09-08T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-08-plans/</id>
		<content type="html">&lt;p&gt;I&#39;ve finished downloading my previous portfolio site from Western&#39;s server. Until I finish pushing the content into this design, it will be accessible either from the link on the right, or by following this link below:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://deptweb.wwu.edu/huxley/huxweb/gis/Portfolio/08/kennym2&quot;&gt;http://deptweb.wwu.edu/huxley/huxweb/gis/Portfolio/08/kennym2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I hope to have it up by the end of the week. Stay tuned.&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>i am matt</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-07-i-am-matt/"/>
		<updated>2008-09-07T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-07-i-am-matt/</id>
		<content type="html">&lt;p&gt;how may i help you visualize the world around us?&lt;/p&gt;
&lt;!-- more --&gt;
</content>
	</entry>
	
	<entry>
		<title>University Courses in GIS</title>
		<link href="https://mattmakesmaps.com/blog/2008-09-07-free-courses-in-gis/"/>
		<updated>2008-09-07T00:00:00Z</updated>
		<id>https://mattmakesmaps.com/blog/2008-09-07-free-courses-in-gis/</id>
		<content type="html">&lt;p&gt;So, like many GIS users, I find myself scouring google for tips / tricks / solutions to problems. These searches regularly lead me to GIS course webpages from various universities. Hurrah for the internet! Right? &lt;!-- more --&gt;&lt;/p&gt;
&lt;p&gt;Some of the best that I have found are in regards to both commercial as well as open source software. I&#39;ve found the following courses to be of particular benefit to me over the last year.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.gis.usu.edu/~jlowry/python/&quot;&gt;Utah State University - WILD 6900 - GIS Programming with Python (ESRI) &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.gis.usu.edu/~chrisg/python/&quot;&gt;Utah State University - WILD 6900 - GIS Programming with Python (Open Source) &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://courseware.e-education.psu.edu/courses/geog585/content/home.html&quot;&gt;Penn State - GEOG 585 - Open Web Mapping &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://ocw.mit.edu/OcwWeb/Urban-Studies-and-Planning/11-521Spatial-Database-Management-and-Advanced-Geographic-Information-SystemsSpring2003/CourseHome/index.htm&quot;&gt;MIT - 11.521 / 11.523 / 11.524 - Database Management and Advanced Geographic Information Systems&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://ocw.mit.edu/OcwWeb/Civil-and-Environmental-Engineering/1-963Fall-2004/CourseHome/&quot;&gt;MIT - 1963 - Environmental Engineering Applications of Geographic Information Systems&lt;/a&gt;&lt;/p&gt;
</content>
	</entry>
</feed>
